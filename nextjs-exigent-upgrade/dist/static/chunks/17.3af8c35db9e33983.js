(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17],{74417:(e,t,n)=>{var r=n(19044)(n(2381),"DataView");e.exports=r},70266:(e,t,n)=>{var r=n(89829),i=n(60734),o=n(35283),a=n(97283),s=n(54778);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},57115:(e,t,n)=>{var r=n(89172),i=n(13314),o=n(73917),a=n(49367),s=n(97126);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},77970:(e,t,n)=>{var r=n(19044)(n(2381),"Map");e.exports=r},8705:(e,t,n)=>{var r=n(59752),i=n(20170),o=n(41069),a=n(28690),s=n(27323);function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,e.exports=l},57780:(e,t,n)=>{var r=n(19044)(n(2381),"Promise");e.exports=r},71936:(e,t,n)=>{var r=n(19044)(n(2381),"Set");e.exports=r},89544:(e,t,n)=>{var r=n(8705),i=n(75912),o=n(74765);function a(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,e.exports=a},45989:(e,t,n)=>{var r=n(57115),i=n(24683),o=n(34813),a=n(35115),s=n(28199),l=n(58644);function u(e){var t=this.__data__=new r(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,e.exports=u},13414:(e,t,n)=>{var r=n(2381).Symbol;e.exports=r},88960:(e,t,n)=>{var r=n(2381).Uint8Array;e.exports=r},93485:(e,t,n)=>{var r=n(19044)(n(2381),"WeakMap");e.exports=r},84537:e=>{e.exports=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}},19206:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}},16347:(e,t,n)=>{var r=n(61747),i=n(6727),o=n(60443),a=n(46551),s=n(41056),l=n(78470),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),c=!n&&i(e),p=!n&&!c&&a(e),d=!n&&!c&&!p&&l(e),f=n||c||p||d,h=f?r(e.length,String):[],y=h.length;for(var g in e)(t||u.call(e,g))&&!(f&&("length"==g||p&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,y)))&&h.push(g);return h}},68165:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},80506:e=>{e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},17232:e=>{e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},22162:(e,t,n)=>{var r=n(27087);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return -1}},11899:(e,t,n)=>{var r=n(30419);e.exports=function(e,t,n,i){return r(e,function(e,r,o){t(i,e,n(e),o)}),i}},85330:(e,t,n)=>{var r=n(98187);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},30419:(e,t,n)=>{var r=n(97385),i=n(23045)(r);e.exports=i},60404:(e,t,n)=>{var r=n(72994)();e.exports=r},97385:(e,t,n)=>{var r=n(60404),i=n(63815);e.exports=function(e,t){return e&&r(e,t,i)}},29013:(e,t,n)=>{var r=n(57442),i=n(83863);e.exports=function(e,t){t=r(t,e);for(var n=0,o=t.length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},83066:(e,t,n)=>{var r=n(80506),i=n(60443);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},12731:(e,t,n)=>{var r=n(13414),i=n(37363),o=n(68391),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},80444:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},35194:(e,t,n)=>{var r=n(12731),i=n(50561);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},43277:(e,t,n)=>{var r=n(36529),i=n(50561);e.exports=function e(t,n,o,a,s){return t===n||(null!=t&&null!=n&&(i(t)||i(n))?r(t,n,o,a,e,s):t!=t&&n!=n)}},36529:(e,t,n)=>{var r=n(45989),i=n(48648),o=n(88264),a=n(44024),s=n(14995),l=n(60443),u=n(46551),c=n(78470),p="[object Arguments]",d="[object Array]",f="[object Object]",h=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,y,g,m){var v=l(e),b=l(t),w=v?d:s(e),x=b?d:s(t);w=w==p?f:w,x=x==p?f:x;var E=w==f,k=x==f,_=w==x;if(_&&u(e)){if(!u(t))return!1;v=!0,E=!1}if(_&&!E)return m||(m=new r),v||c(e)?i(e,t,n,y,g,m):o(e,t,w,n,y,g,m);if(!(1&n)){var j=E&&h.call(e,"__wrapped__"),S=k&&h.call(t,"__wrapped__");if(j||S){var I=j?e.value():e,A=S?t.value():t;return m||(m=new r),g(I,A,n,y,m)}}return!!_&&(m||(m=new r),a(e,t,n,y,g,m))}},29912:(e,t,n)=>{var r=n(45989),i=n(43277);e.exports=function(e,t,n,o){var a=n.length,s=a,l=!o;if(null==e)return!s;for(e=Object(e);a--;){var u=n[a];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<s;){var c=(u=n[a])[0],p=e[c],d=u[1];if(l&&u[2]){if(void 0===p&&!(c in e))return!1}else{var f=new r;if(o)var h=o(p,d,c,e,t,f);if(!(void 0===h?i(d,p,3,o,f):h))return!1}}return!0}},12072:(e,t,n)=>{var r=n(14380),i=n(56711),o=n(63117),a=n(70559),s=/^\[object .+?Constructor\]$/,l=Object.prototype,u=Function.prototype.toString,c=l.hasOwnProperty,p=RegExp("^"+u.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?p:s).test(a(e))}},13272:(e,t,n)=>{var r=n(12731),i=n(44664),o=n(50561),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!a[r(e)]}},37942:(e,t,n)=>{var r=n(41736),i=n(35937),o=n(15502),a=n(60443),s=n(82794);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?a(e)?i(e[0],e[1]):r(e):s(e)}},84238:(e,t,n)=>{var r=n(30761),i=n(93022),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},41736:(e,t,n)=>{var r=n(29912),i=n(36678),o=n(91378);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},35937:(e,t,n)=>{var r=n(43277),i=n(97019),o=n(59628),a=n(59757),s=n(64309),l=n(91378),u=n(83863);e.exports=function(e,t){return a(e)&&s(t)?l(u(e),t):function(n){var a=i(n,e);return void 0===a&&a===t?o(n,e):r(t,a,3)}}},31358:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},65903:(e,t,n)=>{var r=n(29013);e.exports=function(e){return function(t){return r(t,e)}}},61747:e=>{e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},13963:(e,t,n)=>{var r=n(13414),i=n(68165),o=n(60443),a=n(41108),s=1/0,l=r?r.prototype:void 0,u=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(a(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-s?"-0":n}},66127:e=>{e.exports=function(e){return function(t){return e(t)}}},74701:e=>{e.exports=function(e,t){return e.has(t)}},57442:(e,t,n)=>{var r=n(60443),i=n(59757),o=n(57048),a=n(61250);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(a(e))}},45704:(e,t,n)=>{var r=n(2381)["__core-js_shared__"];e.exports=r},17872:(e,t,n)=>{var r=n(84537),i=n(11899),o=n(37942),a=n(60443);e.exports=function(e,t){return function(n,s){var l=a(n)?r:i,u=t?t():{};return l(n,e,o(s,2),u)}}},23045:(e,t,n)=>{var r=n(17806);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,a=t?o:-1,s=Object(n);(t?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},72994:e=>{e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var l=a[e?s:++i];if(!1===n(o[l],l,o))break}return t}}},98187:(e,t,n)=>{var r=n(19044),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},48648:(e,t,n)=>{var r=n(89544),i=n(17232),o=n(74701);e.exports=function(e,t,n,a,s,l){var u=1&n,c=e.length,p=t.length;if(c!=p&&!(u&&p>c))return!1;var d=l.get(e),f=l.get(t);if(d&&f)return d==t&&f==e;var h=-1,y=!0,g=2&n?new r:void 0;for(l.set(e,t),l.set(t,e);++h<c;){var m=e[h],v=t[h];if(a)var b=u?a(v,m,h,t,e,l):a(m,v,h,e,t,l);if(void 0!==b){if(b)continue;y=!1;break}if(g){if(!i(t,function(e,t){if(!o(g,t)&&(m===e||s(m,e,n,a,l)))return g.push(t)})){y=!1;break}}else if(!(m===v||s(m,v,n,a,l))){y=!1;break}}return l.delete(e),l.delete(t),y}},88264:(e,t,n)=>{var r=n(13414),i=n(88960),o=n(27087),a=n(48648),s=n(14774),l=n(94778),u=r?r.prototype:void 0,c=u?u.valueOf:void 0;e.exports=function(e,t,n,r,u,p,d){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!p(new i(e),new i(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=s;case"[object Set]":var h=1&r;if(f||(f=l),e.size!=t.size&&!h)break;var y=d.get(e);if(y)return y==t;r|=2,d.set(e,t);var g=a(f(e),f(t),r,u,p,d);return d.delete(e),g;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},44024:(e,t,n)=>{var r=n(32807),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,a,s){var l=1&n,u=r(e),c=u.length;if(c!=r(t).length&&!l)return!1;for(var p=c;p--;){var d=u[p];if(!(l?d in t:i.call(t,d)))return!1}var f=s.get(e),h=s.get(t);if(f&&h)return f==t&&h==e;var y=!0;s.set(e,t),s.set(t,e);for(var g=l;++p<c;){var m=e[d=u[p]],v=t[d];if(o)var b=l?o(v,m,d,t,e,s):o(m,v,d,e,t,s);if(!(void 0===b?m===v||a(m,v,n,o,s):b)){y=!1;break}g||(g="constructor"==d)}if(y&&!g){var w=e.constructor,x=t.constructor;w!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x)&&(y=!1)}return s.delete(e),s.delete(t),y}},93330:(e,t,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},32807:(e,t,n)=>{var r=n(83066),i=n(75720),o=n(63815);e.exports=function(e){return r(e,o,i)}},58035:(e,t,n)=>{var r=n(36919);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},36678:(e,t,n)=>{var r=n(64309),i=n(63815);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],a=e[o];t[n]=[o,a,r(a)]}return t}},19044:(e,t,n)=>{var r=n(12072),i=n(93039);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},37363:(e,t,n)=>{var r=n(13414),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},75720:(e,t,n)=>{var r=n(19206),i=n(61810),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:r(a(e=Object(e)),function(t){return o.call(e,t)})}:i;e.exports=s},14995:(e,t,n)=>{var r=n(74417),i=n(77970),o=n(57780),a=n(71936),s=n(93485),l=n(12731),u=n(70559),c="[object Map]",p="[object Promise]",d="[object Set]",f="[object WeakMap]",h="[object DataView]",y=u(r),g=u(i),m=u(o),v=u(a),b=u(s),w=l;(r&&w(new r(new ArrayBuffer(1)))!=h||i&&w(new i)!=c||o&&w(o.resolve())!=p||a&&w(new a)!=d||s&&w(new s)!=f)&&(w=function(e){var t=l(e),n="[object Object]"==t?e.constructor:void 0,r=n?u(n):"";if(r)switch(r){case y:return h;case g:return c;case m:return p;case v:return d;case b:return f}return t}),e.exports=w},93039:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},48101:(e,t,n)=>{var r=n(57442),i=n(6727),o=n(60443),a=n(41056),s=n(44664),l=n(83863);e.exports=function(e,t,n){t=r(t,e);for(var u=-1,c=t.length,p=!1;++u<c;){var d=l(t[u]);if(!(p=null!=e&&n(e,d)))break;e=e[d]}return p||++u!=c?p:!!(c=null==e?0:e.length)&&s(c)&&a(d,c)&&(o(e)||i(e))}},89829:(e,t,n)=>{var r=n(91850);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},60734:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},35283:(e,t,n)=>{var r=n(91850),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},97283:(e,t,n)=>{var r=n(91850),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},54778:(e,t,n)=>{var r=n(91850);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},41056:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?0x1fffffffffffff:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},59757:(e,t,n)=>{var r=n(60443),i=n(41108),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!!("number"==n||"symbol"==n||"boolean"==n||null==e||i(e))||a.test(e)||!o.test(e)||null!=t&&e in Object(t)}},36919:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},56711:(e,t,n)=>{var r=n(45704),i=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},30761:e=>{var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},64309:(e,t,n)=>{var r=n(63117);e.exports=function(e){return e==e&&!r(e)}},89172:e=>{e.exports=function(){this.__data__=[],this.size=0}},13314:(e,t,n)=>{var r=n(22162),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},73917:(e,t,n)=>{var r=n(22162);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},49367:(e,t,n)=>{var r=n(22162);e.exports=function(e){return r(this.__data__,e)>-1}},97126:(e,t,n)=>{var r=n(22162);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},59752:(e,t,n)=>{var r=n(70266),i=n(57115),o=n(77970);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},20170:(e,t,n)=>{var r=n(58035);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},41069:(e,t,n)=>{var r=n(58035);e.exports=function(e){return r(this,e).get(e)}},28690:(e,t,n)=>{var r=n(58035);e.exports=function(e){return r(this,e).has(e)}},27323:(e,t,n)=>{var r=n(58035);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},14774:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}},91378:e=>{e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},95325:(e,t,n)=>{var r=n(89830);e.exports=function(e){var t=r(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}},91850:(e,t,n)=>{var r=n(19044)(Object,"create");e.exports=r},93022:(e,t,n)=>{var r=n(23794)(Object.keys,Object);e.exports=r},28079:(e,t,n)=>{e=n.nmd(e);var r=n(93330),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,a=o&&o.exports===i&&r.process,s=function(){try{var e=o&&o.require&&o.require("util").types;if(e)return e;return a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},68391:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},23794:e=>{e.exports=function(e,t){return function(n){return e(t(n))}}},2381:(e,t,n)=>{var r=n(93330),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},75912:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},74765:e=>{e.exports=function(e){return this.__data__.has(e)}},94778:e=>{e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},24683:(e,t,n)=>{var r=n(57115);e.exports=function(){this.__data__=new r,this.size=0}},34813:e=>{e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},35115:e=>{e.exports=function(e){return this.__data__.get(e)}},28199:e=>{e.exports=function(e){return this.__data__.has(e)}},58644:(e,t,n)=>{var r=n(57115),i=n(77970),o=n(8705);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(e,t),this.size=n.size,this}},57048:(e,t,n)=>{var r=n(95325),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)}),t});e.exports=a},83863:(e,t,n)=>{var r=n(41108),i=1/0;e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}},70559:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},27087:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},97019:(e,t,n)=>{var r=n(29013);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},28227:(e,t,n)=>{var r=n(85330),i=n(17872),o=Object.prototype.hasOwnProperty,a=i(function(e,t,n){o.call(e,n)?e[n].push(t):r(e,n,[t])});e.exports=a},59628:(e,t,n)=>{var r=n(80444),i=n(48101);e.exports=function(e,t){return null!=e&&i(e,t,r)}},15502:e=>{e.exports=function(e){return e}},6727:(e,t,n)=>{var r=n(35194),i=n(50561),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(e){return i(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},60443:e=>{var t=Array.isArray;e.exports=t},17806:(e,t,n)=>{var r=n(14380),i=n(44664);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},46551:(e,t,n)=>{e=n.nmd(e);var r=n(2381),i=n(35423),o=t&&!t.nodeType&&t,a=o&&e&&!e.nodeType&&e,s=a&&a.exports===o?r.Buffer:void 0,l=s?s.isBuffer:void 0;e.exports=l||i},14380:(e,t,n)=>{var r=n(12731),i=n(63117);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},44664:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}},63117:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},50561:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},41108:(e,t,n)=>{var r=n(12731),i=n(50561);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},78470:(e,t,n)=>{var r=n(13272),i=n(66127),o=n(28079),a=o&&o.isTypedArray,s=a?i(a):r;e.exports=s},63815:(e,t,n)=>{var r=n(16347),i=n(84238),o=n(17806);e.exports=function(e){return o(e)?r(e):i(e)}},89830:(e,t,n)=>{var r=n(8705);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},82794:(e,t,n)=>{var r=n(31358),i=n(65903),o=n(59757),a=n(83863);e.exports=function(e){return o(e)?r(a(e)):i(e)}},61810:e=>{e.exports=function(){return[]}},35423:e=>{e.exports=function(){return!1}},61250:(e,t,n)=>{var r=n(13963);e.exports=function(e){return null==e?"":r(e)}},53017:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r1});var r=n(57437),i=n(61717);let o={"handshake/syn":i.bK,"handshake/syn-ack":i.Ol,"handshake/ack":i.ei,"channel/response":i.Ag,"channel/heartbeat":i.UE,"channel/disconnect":i.Hq,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},a={[i.bK]:"handshake/syn",[i.Ol]:"handshake/syn-ack",[i.ei]:"handshake/ack",[i.Ag]:"channel/response",[i.UE]:"channel/heartbeat",[i.Hq]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},s=e=>{let{data:t}=e;return t&&"object"==typeof t&&"domain"in t&&"type"in t&&"from"in t&&"to"in t&&("sanity/channels"===t.domain&&(t.domain=i.yK),"overlays"===t.to&&(t.to="visual-editing"),"overlays"===t.from&&(t.from="visual-editing"),t.type=o[t.type]??t.type),e},l=({context:e},t)=>{let{sources:n,targetOrigin:r}=e,o=(e=>(e.domain===i.yK&&(e.domain="sanity/channels"),"visual-editing"===e.to&&(e.to="overlays"),"visual-editing"===e.from&&(e.from="overlays"),e.type=a[e.type]??e.type,"channel/response"===e.type&&e.responseTo&&!e.data&&(e.data={responseTo:e.responseTo}),("handshake/syn"===e.type||"handshake/syn-ack"===e.type||"handshake/ack"===e.type)&&(e.data={id:e.connectionId}),e))(t.message);n.forEach(e=>{e.postMessage(o,{targetOrigin:r})})},u=()=>({listen:(0,i.F8)(s),requestMachine:(0,i.lB)().provide({actions:{"send message":l}})}),c={alt:"altKey",ctrl:"ctrlKey",mod:"u">typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};function p(e){return"Alt"===e.key}var d=n(2265),f=n(1574),h=n(11284),y=n(96934);function g(e){return e.split(/[[.\]]/g).filter(Boolean).map(e=>e.includes("==")?function(e){let[t,n]=e.split("==");if("_key"!==t)throw Error(`Currently only "_key" is supported as path segment. Found ${t}`);if(typeof n>"u")throw Error('Invalid path segment, expected `key=="value"`');return{_key:n.replace(/^['"]/,"").replace(/['"]$/,"")}}(e):m.test(e)?Number(e):e)}let m=/^-?\d+$/,v=/^[a-z_$]+/;function b(e){return e.map((e,t)=>{var n;return n=0===t,Array.isArray(e)?`[${e[0]}:${e[1]||""}]`:"number"==typeof e?`[${e}]`:"object"==typeof e&&"_key"in e&&"string"==typeof e._key?`[_key==${JSON.stringify(e._key)}]`:"string"==typeof e&&v.test(e)?n?e:`.${e}`:`['${e}']`}).join("")}function w(e){if("createIfNotExists"in e)return{type:"createIfNotExists",document:e.createIfNotExists};if("createOrReplace"in e)return{type:"createOrReplace",document:e.createOrReplace};if("create"in e)return{type:"create",document:e.create};if("delete"in e)return{id:e.delete.id,type:"delete"};if("patch"in e){var t,n;return{type:"patch",id:e.patch.id,patches:[..."set"in(n=t=e.patch)?Object.keys(n.set).map(e=>({path:g(e),op:{type:"set",value:n.set[e]}})):[],..."setIfMissing"in t?Object.keys(t.setIfMissing).map(e=>({path:g(e),op:{type:"setIfMissing",value:t.setIfMissing[e]}})):[],..."unset"in t?t.unset.map(e=>({path:g(e),op:{type:"unset"}})):[],..."inc"in t?Object.keys(t.inc).map(e=>({path:g(e),op:{type:"inc",amount:t.inc[e]}})):[],..."inc"in t?Object.keys(t.dec).map(e=>({path:g(e),op:{type:"dec",amount:t.dec[e]}})):[],...function(e){if(!("insert"in e))return[];let t=function(e){let t=x.filter(t=>t in e);if(t.length>1)throw Error(`Insert patch is ambiguous. Should only contain one of: ${x.join(", ")}, instead found ${t.join(", ")}`);return t[0]}(e.insert);if(!t)throw Error("Insert patch missing position");let n=g(e.insert[t]),r=n.pop();return[{path:n,op:{type:"insert",position:t,referenceItem:r,items:e.insert.items}}]}(t)]}}throw Error(`Unknown mutation: ${JSON.stringify(e)}`)}let x=["before","replace","after"];function E(e){return _(e)}function k(e){return e.flatMap(E)}function _(e){if("create"===e.type||"createIfNotExists"===e.type||"createOrReplace"===e.type)return{[e.type]:e.document};if("delete"===e.type)return{delete:{id:e.id}};let t=e.options?.ifRevision;return e.patches.map(n=>({patch:{id:e.id,...t&&{ifRevisionID:t},...function(e){let{path:t,op:n}=e;if("unset"===n.type)return{unset:[b(t)]};if("insert"===n.type)return{insert:{[n.position]:b([...t,n.referenceItem]),items:n.items}};if("diffMatchPatch"===n.type)return{diffMatchPatch:{[b(t)]:n.value}};if("inc"===n.type)return{inc:{[b(t)]:n.amount}};if("dec"===n.type)return{dec:{[b(t)]:n.amount}};if("set"===n.type||"setIfMissing"===n.type)return{[n.type]:{[b(t)]:n.value}};if("truncate"===n.type){let e=[n.startIndex,"number"==typeof n.endIndex?n.endIndex:""].join(":");return{unset:[`${b(t)}[${e}]`]}}if("upsert"===n.type)return{unset:n.items.map(e=>b([...t,{_key:e._key}])),insert:{[n.position]:b([...t,n.referenceItem]),items:n.items}};if("assign"===n.type)return{set:Object.fromEntries(Object.keys(n.value).map(e=>[b(t.concat(e)),n.value[e]]))};if("unassign"===n.type)return{unset:n.keys.map(e=>b(t.concat(e)))};if("replace"===n.type)return{insert:{replace:b(t.concat(n.referenceItem)),items:n.items}};if("remove"===n.type)return{unset:[b(t.concat(n.referenceItem))]};throw Error(`Unknown operation type ${n.type}`)}(n)}}))}function j(e){return Array.isArray(e)?e:[e]}var S=Object.freeze({__proto__:null,decode:function(e){return w(e)},decodeAll:function(e){return e.map(w)},encode:E,encodeAll:k,encodeMutation:_,encodeTransaction:function(e){return{transactionId:e.id,mutations:k(e.mutations)}}});function I(e,t,n){return{type:"insert",referenceItem:n,position:t,items:j(e)}}function A(e,t){return{type:"truncate",startIndex:e,endIndex:t}}function O(e){return{type:"remove",referenceItem:e}}function M(e,t){return{path:"string"==typeof e?g(e):e,op:t}}function P(e){let t=e.charCodeAt(0);return t>=56320&&t<=57343}function $(e){let[t,n]=e;return[t,n]}function C(e,t){let n=e,r=t,i=n.length,o=r.length;if(0===i||0===o)return 0;i>o?n=n.substring(i-o):i<o&&(r=r.substring(0,i));let a=Math.min(i,o);if(n===r)return a;let s=0,l=1;for(let e=0;-1!==e;){let t=n.substring(a-l);if(-1===(e=r.indexOf(t)))break;l+=e,(0===e||n.substring(a-l)===r.substring(0,l))&&(s=l,l++)}return s}function R(e,t){if(!e||!t||e[0]!==t[0])return 0;let n=0,r=Math.min(e.length,t.length),i=r,o=0;for(;n<i;)e.substring(o,i)===t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i}function T(e,t){if(!e||!t||e[e.length-1]!==t[t.length-1])return 0;let n=0,r=Math.min(e.length,t.length),i=r,o=0;for(;n<i;)e.substring(e.length-i,e.length-o)===t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i}function L(e){let t=e.map(e=>$(e)),n=!1,r=[],i=0,o=null,a=0,s=0,l=0,u=0,c=0;for(;a<t.length;)t[a][0]===Z?(r[i++]=a,s=u,l=c,u=0,c=0,o=t[a][1]):(t[a][0]===H?u+=t[a][1].length:c+=t[a][1].length,o&&o.length<=Math.max(s,l)&&o.length<=Math.max(u,c)&&(t.splice(r[i-1],0,[G,o]),t[r[i-1]+1][0]=H,i--,a=--i>0?r[i-1]:-1,s=0,l=0,u=0,c=0,o=null,n=!0)),a++;for(n&&(t=V(t)),t=W(t),a=1;a<t.length;){if(t[a-1][0]===G&&t[a][0]===H){let e=t[a-1][1],n=t[a][1],r=C(e,n),i=C(n,e);r>=i?(r>=e.length/2||r>=n.length/2)&&(t.splice(a,0,[Z,n.substring(0,r)]),t[a-1][1]=e.substring(0,e.length-r),t[a+1][1]=n.substring(r),a++):(i>=e.length/2||i>=n.length/2)&&(t.splice(a,0,[Z,e.substring(0,i)]),t[a-1][0]=H,t[a-1][1]=n.substring(0,n.length-i),t[a+1][0]=G,t[a+1][1]=e.substring(i),a++),a++}a++}return t}let D=/[^a-zA-Z0-9]/,F=/\s/,z=/[\r\n]/,N=/\n\r?\n$/,U=/^\r?\n\r?\n/;function W(e){let t=e.map(e=>$(e));function n(e,t){if(!e||!t)return 6;let n=e.charAt(e.length-1),r=t.charAt(0),i=n.match(D),o=r.match(D),a=i&&n.match(F),s=o&&r.match(F),l=a&&n.match(z),u=s&&r.match(z),c=l&&e.match(N),p=u&&t.match(U);return c||p?5:l||u?4:i&&!a&&s?3:a||s?2:i||o?1:0}let r=1;for(;r<t.length-1;){if(t[r-1][0]===Z&&t[r+1][0]===Z){let e=t[r-1][1],i=t[r][1],o=t[r+1][1],a=T(e,i);if(a){let t=i.substring(i.length-a);e=e.substring(0,e.length-a),i=t+i.substring(0,i.length-a),o=t+o}let s=e,l=i,u=o,c=n(e,i)+n(i,o);for(;i.charAt(0)===o.charAt(0);){e+=i.charAt(0),i=i.substring(1)+o.charAt(0),o=o.substring(1);let t=n(e,i)+n(i,o);t>=c&&(c=t,s=e,l=i,u=o)}t[r-1][1]!==s&&(s?t[r-1][1]=s:(t.splice(r-1,1),r--),t[r][1]=l,u?t[r+1][1]=u:(t.splice(r+1,1),r--))}r++}return t}function V(e){let t,n=e.map(e=>$(e));n.push([Z,""]);let r=0,i=0,o=0,a="",s="";for(;r<n.length;)switch(n[r][0]){case H:o++,s+=n[r][1],r++;break;case G:i++,a+=n[r][1],r++;break;case Z:i+o>1?(0!==i&&0!==o&&(0!==(t=R(s,a))&&(r-i-o>0&&n[r-i-o-1][0]===Z?n[r-i-o-1][1]+=s.substring(0,t):(n.splice(0,0,[Z,s.substring(0,t)]),r++),s=s.substring(t),a=a.substring(t)),0!==(t=T(s,a))&&(n[r][1]=s.substring(s.length-t)+n[r][1],s=s.substring(0,s.length-t),a=a.substring(0,a.length-t))),r-=i+o,n.splice(r,i+o),a.length&&(n.splice(r,0,[G,a]),r++),s.length&&(n.splice(r,0,[H,s]),r++),r++):0!==r&&n[r-1][0]===Z?(n[r-1][1]+=n[r][1],n.splice(r,1)):r++,o=0,i=0,a="",s="";break;default:throw Error("Unknown diff operation")}""===n[n.length-1][1]&&n.pop();let l=!1;for(r=1;r<n.length-1;)n[r-1][0]===Z&&n[r+1][0]===Z&&(n[r][1].substring(n[r][1].length-n[r-1][1].length)===n[r-1][1]?(n[r][1]=n[r-1][1]+n[r][1].substring(0,n[r][1].length-n[r-1][1].length),n[r+1][1]=n[r-1][1]+n[r+1][1],n.splice(r-1,1),l=!0):n[r][1].substring(0,n[r+1][1].length)===n[r+1][1]&&(n[r-1][1]+=n[r+1][1],n[r][1]=n[r][1].substring(n[r+1][1].length)+n[r+1][1],n.splice(r+1,1),l=!0)),r++;return l&&(n=V(n)),n}function B(e,t,n,r,i){let o=e.substring(0,n),a=t.substring(0,r),s=e.substring(n),l=t.substring(r),u=Y(o,a,{checkLines:!1,deadline:i}),c=Y(s,l,{checkLines:!1,deadline:i});return u.concat(c)}function q(e,t,n){let r,i,o,a;let s=e.slice(n,n+Math.floor(e.length/4)),l=-1,u="";for(;-1!==(l=t.indexOf(s,l+1));){let s=R(e.slice(n),t.slice(l)),c=T(e.slice(0,n),t.slice(0,l));u.length<c+s&&(u=t.slice(l-c,l)+t.slice(l,l+s),r=e.slice(0,n-c),i=e.slice(n+s),o=t.slice(0,l-c),a=t.slice(l+s))}return 2*u.length>=e.length?[r||"",i||"",o||"",a||"",u||""]:null}let G=-1,H=1,Z=0;function K(e,t,n){var r,i;let o;if(null===e||null===t)throw Error("Null input. (diff)");let a=Y(e,t,{checkLines:!0,deadline:(i=(r=n||{}).timeout||1,o=1,void 0!==i&&(o=i<=0?Number.MAX_VALUE:i),Date.now()+1e3*o),...r});return function(e){for(let t=0;t<e.length;t++){let[n,r]=e[t];if(0===r.length)continue;let i=r[0];(function(e){let t=e.charCodeAt(0);return t>=55296&&t<=56319})(r[r.length-1])&&n===Z&&Q(e,t,1),P(i)&&n===Z&&Q(e,t,-1)}for(let t=0;t<e.length;t++)0===e[t][1].length&&e.splice(t,1)}(a),a}function Y(e,t,n){let r=e,i=t;if(r===i)return r?[[Z,r]]:[];let o=R(r,i),a=r.substring(0,o);o=T(r=r.substring(o),i=i.substring(o));let s=r.substring(r.length-o),l=function(e,t,n){let r;if(!e)return[[H,t]];if(!t)return[[G,e]];let i=e.length>t.length?e:t,o=e.length>t.length?t:e,a=i.indexOf(o);if(-1!==a)return r=[[H,i.substring(0,a)],[Z,o],[H,i.substring(a+o.length)]],e.length>t.length&&(r[0][0]=G,r[2][0]=G),r;if(1===o.length)return[[G,e],[H,t]];let s=function(e,t){let n,r,i,o,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(s<=0)return null;let l=e.length>t.length?e:t,u=e.length>t.length?t:e;if(l.length<4||2*u.length<l.length)return null;let c=q(l,u,Math.ceil(l.length/4)),p=q(l,u,Math.ceil(l.length/2));if(c&&p)n=c[4].length>p[4].length?c:p;else{if(!c&&!p)return null;p?c||(n=p):n=c}if(!n)throw Error("Unable to find a half match.");return e.length>t.length?(r=n[0],i=n[1],o=n[2],a=n[3]):(o=n[0],a=n[1],r=n[2],i=n[3]),[r,i,o,a,n[4]]}(e,t);if(s){let e=s[0],t=s[1],r=s[2],i=s[3],o=s[4],a=Y(e,r,n),l=Y(t,i,n);return a.concat([[Z,o]],l)}return n.checkLines&&e.length>100&&t.length>100?function(e,t,n){let r=e,i=t,o=function(e,t){let n=[],r={};function i(e){let t="",i=0,a=-1,s=n.length;for(;a<e.length-1;){-1===(a=e.indexOf("\n",i))&&(a=e.length-1);let l=e.slice(i,a+1);(r.hasOwnProperty?r.hasOwnProperty(l):void 0!==r[l])?t+=String.fromCharCode(r[l]):(s===o&&(l=e.slice(i),a=e.length),t+=String.fromCharCode(s),r[l]=s,n[s++]=l),i=a+1}return t}n[0]="";let o=4e4,a=i(e);return o=65535,{chars1:a,chars2:i(t),lineArray:n}}(r,i);r=o.chars1,i=o.chars2;let a=o.lineArray,s=Y(r,i,{checkLines:!1,deadline:n.deadline});!function(e,t){for(let n=0;n<e.length;n++){let r=e[n][1],i=[];for(let e=0;e<r.length;e++)i[e]=t[r.charCodeAt(e)];e[n][1]=i.join("")}}(s,a),(s=L(s)).push([Z,""]);let l=0,u=0,c=0,p="",d="";for(;l<s.length;){switch(s[l][0]){case H:c++,d+=s[l][1];break;case G:u++,p+=s[l][1];break;case Z:if(u>=1&&c>=1){s.splice(l-u-c,u+c),l=l-u-c;let e=Y(p,d,{checkLines:!1,deadline:n.deadline});for(let t=e.length-1;t>=0;t--)s.splice(l,0,e[t]);l+=e.length}c=0,u=0,p="",d="";break;default:throw Error("Unknown diff operation.")}l++}return s.pop(),s}(e,t,n):function(e,t,n){let r=e.length,i=t.length,o=Math.ceil((r+i)/2),a=2*o,s=Array(a),l=Array(a);for(let e=0;e<a;e++)s[e]=-1,l[e]=-1;s[o+1]=0,l[o+1]=0;let u=r-i,c=u%2!=0,p=0,d=0,f=0,h=0;for(let y=0;y<o&&!(Date.now()>n);y++){for(let f=-y+p;f<=y-d;f+=2){let h;let g=o+f,m=(h=f===-y||f!==y&&s[g-1]<s[g+1]?s[g+1]:s[g-1]+1)-f;for(;h<r&&m<i&&e.charAt(h)===t.charAt(m);)h++,m++;if(s[g]=h,h>r)d+=2;else if(m>i)p+=2;else if(c){let i=o+u-f;if(i>=0&&i<a&&-1!==l[i]&&h>=r-l[i])return B(e,t,h,m,n)}}for(let p=-y+f;p<=y-h;p+=2){let d;let g=o+p,m=(d=p===-y||p!==y&&l[g-1]<l[g+1]?l[g+1]:l[g-1]+1)-p;for(;d<r&&m<i&&e.charAt(r-d-1)===t.charAt(i-m-1);)d++,m++;if(l[g]=d,d>r)h+=2;else if(m>i)f+=2;else if(!c){let i=o+u-p;if(i>=0&&i<a&&-1!==s[i]){let a=s[i],l=o+a-i;if(a>=(d=r-d))return B(e,t,a,l,n)}}}}return[[G,e],[H,t]]}(e,t,n.deadline)}(r=r.substring(0,r.length-o),i=i.substring(0,i.length-o),n);return a&&l.unshift([Z,a]),s&&l.push([Z,s]),l=V(l)}function X(e,t,n){return 1===n?e+t:t+e}function J(e,t){return 1===t?[e.substring(0,e.length-1),e[e.length-1]]:[e.substring(1),e[0]]}function Q(e,t,n){var r,i;let o=1===n?-1:1,a=null,s=null,l=t+n;for(;l>=0&&l<e.length&&(null===a||null===s);l+=n){let[r,i]=e[l];if(0!==i.length){if(r===H){null===a&&(a=l);continue}if(r===G){null===s&&(s=l);continue}if(r===Z){if(null===a&&null===s){let[r,i]=J(e[t][1],n);e[t][1]=r,e[l][1]=X(e[l][1],i,o);return}break}}}if(null!==a&&null!==s&&(r=a,i=s,1===n?e[r][1][e[r][1].length-1]===e[i][1][e[i][1].length-1]:e[r][1][0]===e[i][1][0])){let[r,i]=J(e[a][1],o),[l]=J(e[s][1],o);e[a][1]=r,e[s][1]=l,e[t][1]=X(e[t][1],i,n);return}let[u,c]=J(e[t][1],n);e[t][1]=u,null===a?(e.splice(l,0,[H,c]),null!==s&&s>=l&&s++):e[a][1]=X(e[a][1],c,o),null===s?e.splice(l,0,[G,c]):e[s][1]=X(e[s][1],c,o)}let ee={threshold:.5,distance:1e3};function et(e,t,n){if(null===e||null===t||null===n)throw Error("Null input. (match())");let r=Math.max(0,Math.min(n,e.length));return e===t?0:e.length?e.substring(r,r+t.length)===t?r:function(e,t,n){let r,i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.length>32)throw Error("Pattern too long for this browser.");let a={...ee,...o},s=function(e){let t={};for(let n=0;n<e.length;n++)t[e.charAt(n)]=0;for(let n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t}(t);function l(e,r){let i=e/t.length,o=Math.abs(n-r);return a.distance?i+o/a.distance:o?1:i}let u=a.threshold,c=e.indexOf(t,n);-1!==c&&(u=Math.min(l(0,c),u),-1!==(c=e.lastIndexOf(t,n+t.length))&&(u=Math.min(l(0,c),u)));let p=1<<t.length-1;c=-1;let d=t.length+e.length,f=[];for(let o=0;o<t.length;o++){for(r=0,i=d;r<i;)l(o,n+i)<=u?r=i:d=i,i=Math.floor((d-r)/2+r);d=i;let a=Math.max(1,n-i+1),h=Math.min(n+i,e.length)+t.length,y=Array(h+2);y[h+1]=(1<<o)-1;for(let t=h;t>=a;t--){let r=s[e.charAt(t-1)];if(0===o?y[t]=(y[t+1]<<1|1)&r:y[t]=(y[t+1]<<1|1)&r|((f[t+1]|f[t])<<1|1)|f[t+1],y[t]&p){let e=l(o,t-1);if(e<=u){if(u=e,(c=t-1)>n)a=Math.max(1,2*n-c);else break}}}if(l(o+1,n)>u)break;f=y}return c}(e,t,r):-1}function en(e,t){return{diffs:[],start1:e,start2:t,utf8Start1:e,utf8Start2:t,length1:0,length2:0,utf8Length1:0,utf8Length2:0}}function er(e){let t=[];for(let n=0;n<e.length;n++)e[n][0]!==H&&(t[n]=e[n][1]);return t.join("")}function ei(e){let t=[];for(let n=0;n<e.length;n++)e[n][0]!==G&&(t[n]=e[n][1]);return t.join("")}function eo(e){let t=0;for(let n=0;n<e.length;n++){let r=e.codePointAt(n);if(void 0===r)throw Error("Failed to get codepoint");t+=ea(r)}return t}function ea(e){return e<=127?1:e<=2047?2:e<=65535?3:4}let es={margin:4};function el(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...es,...e}}function eu(e,t,n){if(0===t.length)return[];let r=[],i=en(0,0),o=0,a=0,s=0,l=0,u=0,c=e,p=e;for(let e=0;e<t.length;e++){let d=t[e],[f,h]=d,y=h.length,g=eo(h);switch(o||f===Z||(i.start1=a,i.start2=s,i.utf8Start1=l,i.utf8Start2=u),f){case H:i.diffs[o++]=d,i.length2+=y,i.utf8Length2+=g,p=p.substring(0,s)+h+p.substring(s);break;case G:i.length1+=y,i.utf8Length1+=g,i.diffs[o++]=d,p=p.substring(0,s)+p.substring(s+y);break;case Z:y<=2*n.margin&&o&&t.length!==e+1?(i.diffs[o++]=d,i.length1+=y,i.length2+=y,i.utf8Length1+=g,i.utf8Length2+=g):y>=2*n.margin&&o&&(ec(i,c,n),r.push(i),i=en(-1,-1),o=0,c=p,a=s,l=u);break;default:throw Error("Unknown diff type")}f!==H&&(a+=y,l+=g),f!==G&&(s+=y,u+=g)}return o&&(ec(i,c,n),r.push(i)),r}function ec(e,t,n){if(0===t.length)return;let r=t.substring(e.start2,e.start2+e.length1),i=0;for(;t.indexOf(r)!==t.lastIndexOf(r)&&r.length<32-n.margin-n.margin;)i+=n.margin,r=t.substring(e.start2-i,e.start2+e.length1+i);i+=n.margin;let o=e.start2-i;o>=1&&P(t[o])&&o--;let a=t.substring(o,e.start2);a&&e.diffs.unshift([Z,a]);let s=a.length,l=eo(a),u=e.start2+e.length1+i;u<t.length&&P(t[u])&&u++;let c=t.substring(e.start2+e.length1,u);c&&e.diffs.push([Z,c]);let p=c.length,d=eo(c);e.start1-=s,e.start2-=s,e.utf8Start1-=l,e.utf8Start2-=l,e.length1+=s+p,e.length2+=s+p,e.utf8Length1+=l+d,e.utf8Length2+=l+d}function ep(e,t){let n,r=0,i=0,o=0,a=0;for(n=0;n<e.length&&(e[n][0]!==H&&(r+=e[n][1].length),e[n][0]!==G&&(i+=e[n][1].length),!(r>t));n++)o=r,a=i;return e.length!==n&&e[n][0]===G?a:a+(t-o)}function ed(e){let t,n,r;let{utf8Length1:i,utf8Length2:o,utf8Start1:a,utf8Start2:s,diffs:l}=e;t=0===i?"".concat(a,",0"):1===i?"".concat(a+1):"".concat(a+1,",").concat(i),n=0===o?"".concat(s,",0"):1===o?"".concat(s+1):"".concat(s+1,",").concat(o);let u=["@@ -".concat(t," +").concat(n," @@\n")];for(let e=0;e<l.length;e++){switch(l[e][0]){case H:r="+";break;case G:r="-";break;case Z:r=" ";break;default:throw Error("Unknown patch operation.")}u[e+1]="".concat(r+encodeURI(l[e][1]),"\n")}return u.join("").replace(/%20/g," ")}let ef=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;function eh(e){return parseInt(e,10)}var ey=n(28227);let eg=["Value","Copy","Blank","ReturnIntoArray","ReturnIntoObject","ReturnIntoObjectSameKey","PushField","PushElement","PushParent","Pop","PushFieldCopy","PushFieldBlank","PushElementCopy","PushElementBlank","ReturnIntoObjectPop","ReturnIntoObjectSameKeyPop","ReturnIntoArrayPop","ObjectSetFieldValue","ObjectCopyField","ObjectDeleteField","ArrayAppendValue","ArrayAppendSlice","StringAppendString","StringAppendSlice"];class em{constructor(e,t,n){this.model=e,this.root=t,this.patch=n,this.i=0,this.inputStack=[],this.outputStack=[]}read(){return this.patch[this.i++]}process(){for(this.inputStack.push({value:this.root}),this.outputStack.push({value:this.root});this.i<this.patch.length;){let e=this.read(),t=eg[e];if(!t)throw Error(`Unknown opcode: ${e}`);this[`process${t}`].apply(this)}let e=this.outputStack.pop();return this.finalizeOutput(e)}inputEntry(){return this.inputStack[this.inputStack.length-1]}inputKey(e,t){return e.keys||(e.keys=this.model.objectGetKeys(e.value).sort()),e.keys[t]}outputEntry(){return this.outputStack[this.outputStack.length-1]}outputArray(){let e=this.outputEntry();return e.writeValue||(e.writeValue=this.model.copyArray(e.value)),e.writeValue}outputObject(){let e=this.outputEntry();return e.writeValue||(e.writeValue=this.model.copyObject(e.value)),e.writeValue}outputString(){let e=this.outputEntry();return e.writeValue||(e.writeValue=this.model.copyString(e.value)),e.writeValue}finalizeOutput(e){return e.writeValue?this.model.finalize(e.writeValue):e.value}processValue(){let e=this.model.wrap(this.read());this.outputStack.push({value:e})}processCopy(){let e=this.inputEntry();this.outputStack.push({value:e.value})}processBlank(){this.outputStack.push({value:null})}processReturnIntoArray(){let e=this.outputStack.pop(),t=this.finalizeOutput(e),n=this.outputArray();this.model.arrayAppendValue(n,t)}processReturnIntoObject(){let e=this.read(),t=this.outputStack.pop(),n=this.finalizeOutput(t);n=this.model.markChanged(n);let r=this.outputObject();this.model.objectSetField(r,e,n)}processReturnIntoObjectSameKey(){let e=this.inputEntry(),t=this.outputStack.pop(),n=this.finalizeOutput(t),r=this.outputObject();this.model.objectSetField(r,e.key,n)}processPushField(){let e=this.read(),t=this.inputEntry(),n=this.inputKey(t,e),r=this.model.objectGetField(t.value,n);this.inputStack.push({value:r,key:n})}processPushElement(){let e=this.read(),t=this.inputEntry(),n=this.model.arrayGetElement(t.value,e);this.inputStack.push({value:n})}processPop(){this.inputStack.pop()}processPushFieldCopy(){this.processPushField(),this.processCopy()}processPushFieldBlank(){this.processPushField(),this.processBlank()}processPushElementCopy(){this.processPushElement(),this.processCopy()}processPushElementBlank(){this.processPushElement(),this.processBlank()}processReturnIntoObjectPop(){this.processReturnIntoObject(),this.processPop()}processReturnIntoObjectSameKeyPop(){this.processReturnIntoObjectSameKey(),this.processPop()}processReturnIntoArrayPop(){this.processReturnIntoArray(),this.processPop()}processObjectSetFieldValue(){this.processValue(),this.processReturnIntoObject()}processObjectCopyField(){this.processPushField(),this.processCopy(),this.processReturnIntoObjectSameKey(),this.processPop()}processObjectDeleteField(){let e=this.read(),t=this.inputEntry(),n=this.inputKey(t,e),r=this.outputObject();this.model.objectDeleteField(r,n)}processArrayAppendValue(){let e=this.model.wrap(this.read()),t=this.outputArray();this.model.arrayAppendValue(t,e)}processArrayAppendSlice(){let e=this.read(),t=this.read(),n=this.outputArray(),r=this.inputEntry().value;this.model.arrayAppendSlice(n,r,e,t)}processStringAppendString(){let e=this.model.wrap(this.read()),t=this.outputString();this.model.stringAppendValue(t,e)}processStringAppendSlice(){let e=this.read(),t=this.read(),n=this.outputString(),r=this.inputEntry().value;this.model.stringAppendSlice(n,r,e,t)}}function ev(e,t,n=0){let r=n,i=0;for(i=n;r<t;i++){var o;let t=(o=e.codePointAt(i))>>16?4:o>>11?3:o>>7?2:1;4===t&&i++,r+=t}return i}class eb{wrap(e){return e}finalize(e){return Array.isArray(e)?e:e.data}markChanged(e){return e}objectGetKeys(e){return Object.keys(e)}objectGetField(e,t){return e[t]}arrayGetElement(e,t){return e[t]}copyObject(e){let t={type:"object",data:{}};if(null!==e)for(let[n,r]of Object.entries(e))t.data[n]=r;return t}copyArray(e){return null===e?[]:e.slice()}copyString(e){return{type:"string",data:null===e?"":e}}objectSetField(e,t,n){e.data[t]=n}objectDeleteField(e,t){delete e.data[t]}arrayAppendValue(e,t){e.push(t)}arrayAppendSlice(e,t,n,r){e.push(...t.slice(n,r))}stringAppendSlice(e,t,n,r){let i=ev(t,n),o=ev(t,r,i);e.data+=t.slice(i,o)}stringAppendValue(e,t){e.data+=t}}var ew=n(11735),ex=n(10402),eE=n(27196),ek=n(35382),e_=(0,n(23848).d)(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ej=n(81259),eS=n(12256),eI=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,ew.ZT)(t,e),t.prototype.lift=function(e){var t=new eA(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new e_},t.prototype.next=function(e){var t=this;(0,eS.x)(function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,ew.XA)(t.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(e)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}})},t.prototype.error=function(e){var t=this;(0,eS.x)(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})},t.prototype.complete=function(){var e=this;(0,eS.x)(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this.hasError,r=this.isStopped,i=this.observers;return n||r?ek.Lc:(this.currentObservers=null,i.push(e),new ek.w0(function(){t.currentObservers=null,(0,ej.P)(i,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()},t.prototype.asObservable=function(){var e=new eE.y;return e.source=this,e},t.create=function(e,t){return new eA(e,t)},t}(eE.y),eA=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,ew.ZT)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:ek.Lc},t}(eI),eO=n(96550),eM=n(13306);function eP(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new eI}:t,r=e.resetOnError,i=void 0===r||r,o=e.resetOnComplete,a=void 0===o||o,s=e.resetOnRefCountZero,l=void 0===s||s;return function(e){var t,r,o,s=0,u=!1,c=!1,p=function(){null==r||r.unsubscribe(),r=void 0},d=function(){p(),t=o=void 0,u=c=!1},f=function(){var e=t;d(),null==e||e.unsubscribe()};return(0,eM.e)(function(e,h){s++,c||u||p();var y=o=null!=o?o:n();h.add(function(){0!=--s||c||u||(r=e$(f,l))}),y.subscribe(h),!t&&s>0&&(t=new eO.Hp({next:function(e){return y.next(e)},error:function(e){c=!0,p(),r=e$(d,i,e),y.error(e)},complete:function(){u=!0,p(),r=e$(d,a),y.complete()}}),(0,ex.Xf)(e).subscribe(t))})(e)}}function e$(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0===t){e();return}if(!1!==t){var i=new eO.Hp({next:function(){i.unsubscribe(),e()}});return(0,ex.Xf)(t.apply(void 0,(0,ew.ev)([],(0,ew.CR)(n)))).subscribe(i)}}var eC=n(71134),eR=n(54196),eT=n(8533),eL=n(74222),eD=n(11665),eF=n(78892);function ez(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(0,eD.yG)(t),i=(0,eD._6)(t,1/0);return t.length?1===t.length?(0,ex.Xf)(t[0]):(void 0===(e=i)&&(e=1/0),(0,eR.z)(eT.y,e))((0,eF.D)(t,r)):eL.E}var eN={now:function(){return(eN.delegate||Date).now()},delegate:void 0},eU=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=eN);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return(0,ew.ZT)(t,e),t.prototype.next=function(t){var n=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,o=this._timestampProvider,a=this._windowTime;!n&&(r.push(t),i||r.push(o.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var o=t.now(),a=0,s=1;s<n.length&&n[s]<=o;s+=2)a=s;a&&n.splice(0,a+1)}},t}(eI),eW=n(61125),eV=n(57762),eB=function(e){function t(t,n){return e.call(this)||this}return(0,ew.ZT)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(ek.w0),eq={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=eq.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,(0,ew.ev)([e,t],(0,ew.CR)(n))):setInterval.apply(void 0,(0,ew.ev)([e,t],(0,ew.CR)(n)))},clearInterval:function(e){var t=eq.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},eG=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return(0,ew.ZT)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n,r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),eq.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&eq.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ej.P)(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(eB),eH=1,eZ={};function eK(e){return e in eZ&&(delete eZ[e],!0)}var eY={setImmediate:function(e){var t=eH++;return eZ[t]=!0,n_||(n_=Promise.resolve()),n_.then(function(){return eK(t)&&e()}),t},clearImmediate:function(e){eK(e)}},eX=eY.setImmediate,eJ=eY.clearImmediate,eQ={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=eQ.delegate;return((null==n?void 0:n.setImmediate)||eX).apply(void 0,(0,ew.ev)([],(0,ew.CR)(e)))},clearImmediate:function(e){var t=eQ.delegate;return((null==t?void 0:t.clearImmediate)||eJ)(e)},delegate:void 0},e0=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return(0,ew.ZT)(t,e),t.prototype.requestAsyncId=function(t,n,r){return(void 0===r&&(r=0),null!==r&&r>0)?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=eQ.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var i,o=t.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(eQ.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}(eG),e1=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=eN.now,e}(),e2=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,ew.ZT)(t,e),t.prototype.flush=function(e){this._active=!0;var t,n=this._scheduled;this._scheduled=void 0;var r=this.actions;e=e||r.shift();do if(t=e.execute(e.state,e.delay))break;while((e=r[0])&&e.id===n&&r.shift());if(this._active=!1,t){for(;(e=r[0])&&e.id===n&&r.shift();)e.unsubscribe();throw t}},t}(function(e){function t(t,n){void 0===n&&(n=e1.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return(0,ew.ZT)(t,e),t.prototype.flush=function(e){var t,n=this.actions;if(this._active){n.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,t){for(;e=n.shift();)e.unsubscribe();throw t}},t}(e1)))(e0),e3=n(61953);function e8(e){if("patch"===e.type)return e.id;if("create"===e.type)return e.document._id;if("delete"===e.type)return e.id;if("createIfNotExists"===e.type||"createOrReplace"===e.type)return e.document._id;throw Error("Invalid mutation type")}let e4=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[e]];return t};function e5(e){return"string"==typeof e?._key}function e7(e){return"object"==typeof e&&"_key"in e&&"string"==typeof e._key}function e9(e){return"number"==typeof e||e7(e)}function e6(e,t){if(0===e.length)return t;let n=t;for(let t of e){if(e9(t)){if(!Array.isArray(n))return;if(e7(t)){n=n.find(e=>e._key===t._key);continue}n=n[t];continue}n=n[t]}return n}let te=/^[a-z_$]+/;function tt(e){return e.map((e,t)=>{var n;return n=0===t,Array.isArray(e)?`[${e[0]}:${e[1]||""}]`:"number"==typeof e?`[${e}]`:e7(e)?`[_key==${JSON.stringify(e._key)}]`:"string"==typeof e&&te.test(e)?n?e:`.${e}`:`['${e}']`}).join("")}function tn(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function tr(e,t){if("number"==typeof t)return function(e,t){if(0===e&&(-1===t||0===t))return 0;let n=t<0?e+t:t;return n>=e||n<0?null:n}(e.length,t);if(e7(t)){let n=e.findIndex(e=>(null!==e&&"object"==typeof e&&"string"==typeof e._key&&e._key||null)===t._key);return -1===n?null:n}throw Error(`Expected path segment to be addressing a single array item either by numeric index or by '_key'. Instead saw ${JSON.stringify(t)}`)}function ti(e,t,n,r){let i=e.slice();return i.splice(t,n,...r||[]),i}function to(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "insert()" on non-array value');let n=tr(t,e.referenceItem);if(null===n)throw Error(`Found no matching array element to insert ${e.position}`);return 0===t.length?e.items:ti(t,"before"===e.position?n:n+1,0,e.items)}let ta=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty);var ts=Object.freeze({__proto__:null,assign:function(e,t){if(!tn(t))throw TypeError('Cannot apply "assign()" on non-object value');return!function(e){for(let t in e)if(ta(e,t))return!1;return!0}(e.value)?{...t,...e.value}:t},dec:function(e,t){if("number"!=typeof t)throw TypeError('Cannot apply "dec()" on non-numeric value');return t-e.amount},diffMatchPatch:function(e,t){if("string"!=typeof t)throw TypeError('Cannot apply "diffMatchPatch()" on non-string value');return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof e)throw Error("Patches must be an array - pass the patch to `parsePatch()` first");let r=t;if(0===e.length)return[r,[]];let i=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=0,i=0;function o(e){for(;r<e;){let e=t.codePointAt(i);if(void 0===e)return i;r+=ea(e),e>65535?i+=2:i+=1}if(!n.allowExceedingIndices&&r!==e)throw Error("Failed to determine byte offset");return i}let a=[];for(let t of e)a.push({diffs:t.diffs.map(e=>$(e)),start1:o(t.start1),start2:o(t.start2),utf8Start1:t.utf8Start1,utf8Start2:t.utf8Start2,length1:t.length1,length2:t.length2,utf8Length1:t.utf8Length1,utf8Length2:t.utf8Length2});return a}(e,r,{allowExceedingIndices:n.allowExceedingIndices}),o=n.margin||4,a=n.deleteThreshold||.4,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n="";for(let e=1;e<=t;e++)n+=String.fromCharCode(e);for(let n of e)n.start1+=t,n.start2+=t,n.utf8Start1+=t,n.utf8Start2+=t;let r=e[0],i=r.diffs;if(0===i.length||i[0][0]!==Z)i.unshift([Z,n]),r.start1-=t,r.start2-=t,r.utf8Start1-=t,r.utf8Start2-=t,r.length1+=t,r.length2+=t,r.utf8Length1+=t,r.utf8Length2+=t;else if(t>i[0][1].length){let e=i[0][1].length,o=t-e;i[0][1]=n.substring(e)+i[0][1],r.start1-=o,r.start2-=o,r.utf8Start1-=o,r.utf8Start2-=o,r.length1+=o,r.length2+=o,r.utf8Length1+=o,r.utf8Length2+=o}if(0===(i=(r=e[e.length-1]).diffs).length||i[i.length-1][0]!==Z)i.push([Z,n]),r.length1+=t,r.length2+=t,r.utf8Length1+=t,r.utf8Length2+=t;else if(t>i[i.length-1][1].length){let e=t-i[i.length-1][1].length;i[i.length-1][1]+=n.substring(0,e),r.length1+=e,r.length2+=e,r.utf8Length1+=e,r.utf8Length2+=e}return n}(i,o);r=s+r+s,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;for(let n=0;n<e.length;n++){if(e[n].length1<=32)continue;let r=e[n];e.splice(n--,1);let i=r.start1,o=r.start2,a="";for(;0!==r.diffs.length;){let s=en(i-a.length,o-a.length),l=!0;if(""!==a){let e=eo(a);s.length1=a.length,s.utf8Length1=e,s.length2=a.length,s.utf8Length2=e,s.diffs.push([Z,a])}for(;0!==r.diffs.length&&s.length1<32-t;){let e=r.diffs[0][0],n=r.diffs[0][1],a=eo(n);if(e===H){s.length2+=n.length,s.utf8Length2+=a,o+=n.length;let e=r.diffs.shift();e&&s.diffs.push(e),l=!1}else e===G&&1===s.diffs.length&&s.diffs[0][0]===Z&&n.length>64?(s.length1+=n.length,s.utf8Length1+=a,i+=n.length,l=!1,s.diffs.push([e,n]),r.diffs.shift()):(a=eo(n=n.substring(0,32-s.length1-t)),s.length1+=n.length,s.utf8Length1+=a,i+=n.length,e===Z?(s.length2+=n.length,s.utf8Length2+=a,o+=n.length):l=!1,s.diffs.push([e,n]),n===r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(n.length))}a=(a=ei(s.diffs)).substring(a.length-t);let u=er(r.diffs).substring(0,t),c=eo(u);""!==u&&(s.length1+=u.length,s.length2+=u.length,s.utf8Length1+=c,s.utf8Length2+=c,0!==s.diffs.length&&s.diffs[s.diffs.length-1][0]===Z?s.diffs[s.diffs.length-1][1]+=u:s.diffs.push([Z,u])),l||e.splice(++n,0,s)}}}(i,o);let l=0,u=[];for(let e=0;e<i.length;e++){let t;let n=i[e].start2+l,o=er(i[e].diffs),s=-1;if(o.length>32?-1!==(t=et(r,o.substring(0,32),n))&&(-1===(s=et(r,o.substring(o.length-32),n+o.length-32))||t>=s)&&(t=-1):t=et(r,o,n),-1===t)u[e]=!1,l-=i[e].length2-i[e].length1;else{let c;if(u[e]=!0,l=t-n,c=-1===s?r.substring(t,t+o.length):r.substring(t,s+32),o===c)r=r.substring(0,t)+ei(i[e].diffs)+r.substring(t+o.length);else{let n=K(o,c,{checkLines:!1});if(o.length>32&&function(e){let t=0,n=0,r=0;for(let i=0;i<e.length;i++){let o=e[i][0],a=e[i][1];switch(o){case H:n+=a.length;break;case G:r+=a.length;break;case Z:t+=Math.max(n,r),n=0,r=0;break;default:throw Error("Unknown diff operation.")}}return t+Math.max(n,r)}(n)/o.length>a)u[e]=!1;else{n=W(n);let o=0,a=0;for(let s=0;s<i[e].diffs.length;s++){let l=i[e].diffs[s];l[0]!==Z&&(a=ep(n,o)),l[0]===H?r=r.substring(0,t+a)+l[1]+r.substring(t+a):l[0]===G&&(r=r.substring(0,t+a)+r.substring(t+ep(n,o+l[1].length))),l[0]!==G&&(o+=l[1].length)}}}}}return[r=r.substring(s.length,r.length-s.length),u]}(function(e){if(!e)return[];let t=[],n=e.split("\n"),r=0;for(;r<n.length;){let e=n[r].match(ef);if(!e)throw Error("Invalid patch string: ".concat(n[r]));let i=en(eh(e[1]),eh(e[3]));for(t.push(i),""===e[2]?(i.start1--,i.utf8Start1--,i.length1=1,i.utf8Length1=1):"0"===e[2]?(i.length1=0,i.utf8Length1=0):(i.start1--,i.utf8Start1--,i.utf8Length1=eh(e[2]),i.length1=i.utf8Length1),""===e[4]?(i.start2--,i.utf8Start2--,i.length2=1,i.utf8Length2=1):"0"===e[4]?(i.length2=0,i.utf8Length2=0):(i.start2--,i.utf8Start2--,i.utf8Length2=eh(e[4]),i.length2=i.utf8Length2),r++;r<n.length;){let e;let t=n[r],o=t.charAt(0);if("@"===o)break;if(""===o){r++;continue}try{e=decodeURI(t.slice(1))}catch(e){throw Error("Illegal escape in parse: ".concat(t))}let a=eo(e)-e.length;if("-"===o)i.diffs.push([G,e]),i.length1-=a;else if("+"===o)i.diffs.push([H,e]),i.length2-=a;else if(" "===o)i.diffs.push([Z,e]),i.length1-=a,i.length2-=a;else throw Error('Invalid patch mode "'.concat(o,'" in: ').concat(e));r++}}return t}(e.value),t)[0]},inc:function(e,t){if("number"!=typeof t)throw TypeError('Cannot apply "inc()" on non-numeric value');return t+e.amount},insert:to,remove:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "remove()" on non-array value');let n=tr(t,e.referenceItem);if(null===n)throw Error("Found no matching array element to replace");return ti(t,n,1,[])},replace:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "replace()" on non-array value');let n=tr(t,e.referenceItem);if(null===n)throw Error("Found no matching array element to replace");return ti(t,n,e.items.length,e.items)},set:function(e,t){return e.value},setIfMissing:function(e,t){return t??e.value},truncate:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "truncate()" on non-array value');return"number"==typeof e.endIndex?t.slice(0,e.startIndex).concat(t.slice(e.endIndex)):t.slice(0,e.startIndex)},unassign:function(e,t){if(!tn(t))throw TypeError('Cannot apply "unassign()" on non-object value');return 0===e.keys.length?t:function(e,t){let n={...e};for(let e of t)delete n[e];return n}(t,e.keys)},unset:function(e){},upsert:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "upsert()" on non-array value');if(0===e.items.length)return t;let n=[],r=[];if(e.items.forEach((e,i)=>{let o=t.findIndex(t=>t?._key===e._key);o>=0?n[o]=i:r.push(e)}),0===n.length&&0==r.length)return t;let i=[...t];for(let t of n)i[t]=e.items[n[t]];return to({type:"insert",items:r,referenceItem:e.referenceItem,position:e.position},i)}});function tl(e,t){return e.reduce((e,t)=>tu(t,e),t)}function tu(e,t){return function e(t,n,r){if(!(t.length>0))return function(e,t){if(!(e.type in ts))throw Error(`Invalid operation type: "${e.type}"`);return ts[e.type](e,t)}(n,r);let[i,...o]=t;if(e9(i)&&Array.isArray(r))return function(t,n,r,i){let o=tr(i,t);if(null===o||-1===o)return i;let a=i[o],s=e(n,r,a);return s===a?i:ti(i,o,1,[s])}(i,o,n,r);if("string"==typeof i&&tn(r))return function(t,n,r,i){let o=i[t];if(void 0===o&&n.length>0)return i;let a=e(n,r,o);return a===o?i:{...i,[t]:a}}(i,o,n,r);throw Error(`Cannot apply operation of type "${n.type}" to path ${tt(t)} on ${typeof r} value`)}(e.path,e.op,t)}function tc(e){return"_id"in e}function tp(e,t){return t.reduce((e,t)=>{let n=td(e,t);if("error"===n.status)throw Error(n.message);return"noop"===n.status?e:n.after},e)}function td(e,t){if("create"===t.type)return function(e,t){var n;if(e)return{status:"error",message:"Document already exist"};let r=tc(n=t.document)?n:{...n,_id:e4()};return{status:"created",id:r._id,after:r}}(e,t);if("createIfNotExists"===t.type)return tc(t.document)?e?{status:"noop"}:{status:"created",id:t.document._id,after:t.document}:{status:"error",message:"Cannot createIfNotExists on document without _id"};if("delete"===t.type)return e?t.id!==e._id?{status:"error",message:"Delete mutation targeted wrong document"}:{status:"deleted",id:t.id,before:e,after:void 0}:{status:"noop"};if("createOrReplace"===t.type)return tc(t.document)?e?{status:"updated",id:t.document._id,before:e,after:t.document}:{status:"created",id:t.document._id,after:t.document}:{status:"error",message:"Cannot createIfNotExists on document without _id"};if("patch"===t.type)return function(e,t){if(!e)return{status:"error",message:"Cannot apply patch on nonexistent document"};let n=function(e,t){if(e.options?.ifRevision&&t._rev!==e.options.ifRevision)throw Error("Revision mismatch");if(e.id!==t._id)throw Error(`Document id mismatch. Refusing to apply mutation for document with id="${e.id}" on the given document with id="${t._id}"`);return tl(e.patches,t)}(t,e);return e===n?{status:"noop"}:{status:"updated",id:t.id,before:e,after:n}}(e,t);throw Error(`Invalid mutation type: ${t.type}`)}function tf(e,t,n){let r=[];for(let n of e.slice().reverse()){if(t(n))return r;r.push(n)}return r.reverse()}function th(e,t){return tt(e)===tt(t)}function ty(e,t){let n=e;return t.reduce((e,t)=>{let r=n;if(n=tu(t,n),"set"===t.op.type&&"string"==typeof t.op.value){let n=e6(t.path,r);if("string"==typeof n){let r={...t,op:{type:"diffMatchPatch",value:(function(e,t,n){if("string"==typeof e&&"string"==typeof t){let n=K(e,t,{checkLines:!0});return n.length>2&&(n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=e.map(e=>$(e)),r=!1,i=[],o=0,a=null,s=0,l=!1,u=!1,c=!1,p=!1;for(;s<n.length;)n[s][0]===Z?(n[s][1].length<t&&(c||p)?(i[o++]=s,l=c,u=p,a=n[s][1]):(o=0,a=null),c=!1,p=!1):(n[s][0]===G?p=!0:c=!0,a&&(l&&u&&c&&p||a.length<t/2&&3===function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>e+(t?1:0),0)}(l,u,c,p))&&(n.splice(i[o-1],0,[G,a]),n[i[o-1]+1][0]=H,o--,a=null,l&&u?(c=!0,p=!0,o=0):(s=--o>0?i[o-1]:-1,c=!1,p=!1),r=!0)),s++;return r&&(n=V(n)),n}(n=L(n))),eu(e,n,el(void 0))}if(e&&Array.isArray(e)&&void 0===t)return eu(er(e),e,el(n));if("string"==typeof e&&t&&Array.isArray(t))return eu(e,t,el(n));throw Error("Unknown call format to make()")})(n,t.op.value).map(ed).join("")}};return e.flatMap(e=>th(e.path,t.path)&&"diffMatchPatch"===e.op.type?[]:e).concat(r)}}return e.push(t),e},[])}function tg(e,t,n,r){let i=t,o=r.map(t=>{let n=t.mutations.flatMap(t=>{if(e8(t)!==e)return[];let n=i;return i=tp(i,[t]),n&&"patch"===t.type?{type:"dmpified",mutation:{...t,dmpPatches:ty(n,t.patches),original:t.patches}}:t});return{...t,mutations:n}}),a=n;return o.map(t=>{let n=[];return t.mutations.forEach(t=>{if("dmpified"===t.type)try{a=tl(t.mutation.dmpPatches,a),n.push(t)}catch{console.warn("Failed to apply dmp patch, falling back to original");try{a=tl(t.mutation.original,a),n.push(t)}catch(t){throw Error(`Failed to apply patch for document "${e}": ${t.message}`)}}else a=tp(a,[t])})}),[r.map(t=>({...t,mutations:t.mutations.map(t=>"patch"!==t.type||e8(t)!==e?t:{...t,patches:t.patches.map(e=>"set"!==e.op.type?e:{...e,op:{...e.op,value:e6(e.path,a)}})})})),a]}function tm(e){return function(e){if("create"===e.type||"createIfNotExists"===e.type||"createOrReplace"===e.type)return{[e.type]:e.document};if("delete"===e.type)return{delete:{id:e.id}};let t=e.options?.ifRevision;return e.patches.map(n=>({patch:{id:e.id,...t&&{ifRevisionID:t},...function(e){let{path:t,op:n}=e;if("unset"===n.type)return{unset:[tt(t)]};if("insert"===n.type)return{insert:{[n.position]:tt([...t,n.referenceItem]),items:n.items}};if("diffMatchPatch"===n.type)return{diffMatchPatch:{[tt(t)]:n.value}};if("inc"===n.type)return{inc:{[tt(t)]:n.amount}};if("dec"===n.type)return{dec:{[tt(t)]:n.amount}};if("set"===n.type||"setIfMissing"===n.type)return{[n.type]:{[tt(t)]:n.value}};if("truncate"===n.type){let e=[n.startIndex,"number"==typeof n.endIndex?n.endIndex:""].join(":");return{unset:[`${tt(t)}[${e}]`]}}if("upsert"===n.type)return{unset:n.items.map(e=>tt([...t,{_key:e._key}])),insert:{[n.position]:tt([...t,n.referenceItem]),items:n.items}};if("assign"===n.type)return{set:Object.fromEntries(Object.keys(n.value).map(e=>[tt(t.concat(e)),n.value[e]]))};if("unassign"===n.type)return{unset:n.keys.map(e=>tt(t.concat(e)))};if("replace"===n.type)return{insert:{replace:tt(t.concat(n.referenceItem)),items:n.items}};if("remove"===n.type)return{unset:[tt(t.concat(n.referenceItem))]};throw Error(`Unknown operation type ${n.type}`)}(n)}}))}(e)}function tv(e){var t,n,r,i,o,a,s,l;let u=e.listen('*[!(_id in path("_.**"))]',{},{events:["welcome","mutation","reconnect"],includeResult:!1,includePreviousRevision:!1,visibility:"transaction",effectFormat:"mendoza",includeMutations:!1}).pipe(eP({resetOnRefCountZero:!0})),c=u.pipe((0,eC.h)(e=>"reconnect"===e.type)),p=u.pipe((0,eC.h)(e=>"welcome"===e.type)),d=u.pipe((0,eC.h)(e=>"mutation"===e.type)),f=ez(p,c).pipe((l=!1,s=void 0===(i=(t={bufferSize:1,refCount:!0}).bufferSize)?1/0:i,n=void 0===(o=t.windowTime)?1/0:o,l=void 0!==(a=t.refCount)&&a,r=t.scheduler,eP({connector:function(){return new eU(s,n,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:l}))).pipe((0,eC.h)(e=>"welcome"===e.type));return ez(f,d,c)}let tb=(0,e3.cY)({types:{},actions:{"assign error to context":(0,h.a)({error:({event:e})=>e}),"clear error from context":(0,h.a)({error:void 0}),"connect to server-sent events":(0,y.O)({type:"connect"}),"listen to server-sent events":(0,y.P)("server-sent events",{id:"listener",input:({context:e})=>({listener:e.sharedListener||tv(e.client),id:e.id})}),"stop listening to server-sent events":(0,y.R)("listener"),"buffer remote mutation events":(0,h.a)({mutationEvents:({event:e,context:t})=>((0,e3.ZD)(e,"mutation"),[...t.mutationEvents,e])}),"restore stashed changes":(0,h.a)({stagedChanges:({event:e,context:t})=>((0,e3.ZD)(e,"xstate.done.actor.submitTransactions"),t.stashedChanges),stashedChanges:[]}),"rebase fetched remote snapshot":(0,h.b)(({enqueue:e})=>{e.assign(({event:e,context:t})=>{(0,e3.ZD)(e,"xstate.done.actor.getDocument");let n=t.remote,r=e.output,i=!1;for(let e of t.mutationEvents)e.effects?.apply&&(e.previousRev||"appear"===e.transition)&&(i||e.previousRev!==r?._rev||(i=!0),i&&(r=tw(r,e.effects.apply,e.resultRev)));t.cache&&(!t.cache.has(t.id)||t.cache.get(t.id)._rev!==r?._rev)&&t.cache.set(t.id,r);let[o,a]=tg(t.id,null===n?void 0:n,null===r?void 0:r,t.stagedChanges);return{remote:r,local:a,stagedChanges:o,mutationEvents:[]}}),e.sendParent(({context:e})=>({type:"rebased.remote",id:e.id,document:e.remote}))}),"apply mendoza patch":(0,h.a)(({event:e,context:t})=>{(0,e3.ZD)(e,"mutation");let n=t.remote;if(e.transactionId===n?._rev)return{};let r=tw(n,e.effects.apply,e.resultRev);t.cache&&(!t.cache.has(t.id)||t.cache.get(t.id)._rev!==r?._rev)&&t.cache.set(t.id,r);let[i,o]=tg(t.id,null===n?void 0:n,null===r?void 0:r,t.stagedChanges);return{remote:r,local:o,stagedChanges:i}}),"increment fetch attempts":(0,h.a)({fetchRemoteSnapshotAttempts:({context:e})=>e.fetchRemoteSnapshotAttempts+1}),"reset fetch attempts":(0,h.a)({fetchRemoteSnapshotAttempts:0}),"increment submit attempts":(0,h.a)({submitTransactionsAttempts:({context:e})=>e.submitTransactionsAttempts+1}),"reset submit attempts":(0,h.a)({submitTransactionsAttempts:0}),"stage mutation":(0,h.a)({stagedChanges:({event:e,context:t})=>((0,e3.ZD)(e,"mutate"),[...t.stagedChanges,{transaction:!1,mutations:e.mutations}])}),"stash mutation":(0,h.a)({stashedChanges:({event:e,context:t})=>((0,e3.ZD)(e,"mutate"),[...t.stashedChanges,{transaction:!1,mutations:e.mutations}])}),"rebase local snapshot":(0,h.b)(({enqueue:e})=>{e.assign({local:({event:e,context:t})=>{(0,e3.ZD)(e,"mutate");let n=new Map;return t.local&&n.set(t.id,t.local),function(e,t){e.forEach(e=>{("created"===e.status||"updated"===e.status)&&t.set(e.id,e.after),"deleted"===e.status&&t.delete(e.id)})}(function(e,t){let n=Object.create(null);for(let r of e){let e=e8(r);if(!e)throw Error("Unable to get document id from mutation");let i=n[e]?.after||t.get(e),o=td(i,r);if("error"===o.status)throw Error(o.message);"noop"!==o.status&&("updated"===o.status||"created"===o.status||"deleted"===o.status)&&(e in n||(n[e]={before:i,after:void 0,muts:[]}),n[e].after=o.after)}return Object.entries(n).map(([e,{before:t,after:n,muts:r}])=>({id:e,status:n?t?"updated":"created":"deleted",mutations:r,before:t,after:n}))}(e.mutations,n),n),n.get(t.id)}}),e.sendParent(({context:e})=>({type:"rebased.local",id:e.id,document:e.local}))}),"send pristine event to parent":(0,h.s)(({context:e})=>({type:"pristine",id:e.id})),"send sync event to parent":(0,h.s)(({context:e})=>({type:"sync",id:e.id,document:e.remote})),"send mutation event to parent":(0,h.s)(({context:e,event:t})=>((0,e3.ZD)(t,"mutation"),{type:"mutation",id:e.id,previousRev:t.previousRev,resultRev:t.resultRev,effects:t.effects}))},actors:{"server-sent events":(0,f.Y$)(({input:e})=>{let{listener:t,id:n}=e;return(0,eW.P)(()=>t).pipe((0,eC.h)(e=>"welcome"===e.type||"reconnect"===e.type||"mutation"===e.type&&e.documentId===n),(0,eV.Q)(e2))}),"fetch remote snapshot":(0,f.p4)(async({input:e,signal:t})=>{let{client:n,id:r}=e;return await n.getDocument(r,{signal:t}).catch(e=>{if(!(e instanceof Error&&"AbortError"===e.name))throw e})}),"submit mutations as transactions":(0,f.p4)(async({input:e,signal:t})=>{let{client:n,transactions:r}=e;for(let e of r){if(t.aborted)return;await n.dataRequest("mutate",function(e){return{transactionId:e.id,mutations:e.mutations.flatMap(tm)}}(e),{visibility:"async",returnDocuments:!1,signal:t}).catch(e=>{if(!(e instanceof Error&&"AbortError"===e.name))throw e})}})},delays:{fetchRemoteSnapshotTimeout:({context:e})=>1e3*Math.pow(2,e.fetchRemoteSnapshotAttempts),submitTransactionsTimeout:({context:e})=>1e3*Math.pow(2,e.submitTransactionsAttempts)}}).createMachine({id:"document-mutator",context:({input:e})=>({client:e.client.withConfig({allowReconfigure:!1}),sharedListener:e.sharedListener,id:e.id,remote:void 0,local:void 0,mutationEvents:[],stagedChanges:[],stashedChanges:[],error:void 0,fetchRemoteSnapshotAttempts:0,submitTransactionsAttempts:0,cache:e.cache}),entry:["connect to server-sent events"],on:{mutate:{actions:["rebase local snapshot","stage mutation"]}},initial:"disconnected",states:{disconnected:{on:{connect:{target:"connecting",actions:["listen to server-sent events"]}}},connecting:{on:{welcome:"connected",reconnect:"reconnecting",error:"connectFailure"},tags:["busy"]},connectFailure:{on:{connect:{target:"connecting",actions:["listen to server-sent events"]}},entry:["stop listening to server-sent events","assign error to context"],exit:["clear error from context"],tags:["error"]},reconnecting:{on:{welcome:{target:"connected"},error:{target:"connectFailure"}},tags:["busy","error"]},connected:{on:{mutation:{actions:["buffer remote mutation events"]},reconnect:"reconnecting"},entry:["clear error from context"],initial:"loading",states:{loading:{invoke:{src:"fetch remote snapshot",id:"getDocument",input:({context:e})=>({client:e.client,id:e.id}),onError:{target:"loadFailure"},onDone:{target:"loaded",actions:["rebase fetched remote snapshot","reset fetch attempts"]}},tags:["busy"]},loaded:{entry:["send sync event to parent"],on:{mutation:{actions:["apply mendoza patch","send mutation event to parent"]}},initial:"pristine",states:{pristine:{on:{mutate:{actions:["rebase local snapshot","stage mutation"],target:"dirty"}},tags:["ready"]},dirty:{on:{submit:"submitting"},tags:["ready"]},submitting:{on:{mutate:{actions:["rebase local snapshot","stash mutation"]}},invoke:{src:"submit mutations as transactions",id:"submitTransactions",input:({context:e})=>{let t=new Map;return t.set(e.id,e.remote),{client:e.client,transactions:(function(e,t){let n=[],r=[];return e.forEach(e=>{t(e)?r.push(e):(r.length>0&&n.push(r),r=[],n.push([e]))}),r.length>0&&n.push(r),n})(e.stagedChanges,e=>!e.transaction).flatMap(e=>({...e[0],mutations:e.flatMap(e=>e.mutations)})).map(e=>({...e,mutations:Object.values(ey(e.mutations,e8)).flatMap(e=>{var t;return(0===(t=0===e.length?e:e.reduce((e,t)=>"delete"===t.type?[t]:(e.push(t),e),[])).length?t:t.reduce((e,t)=>("createIfNotExists"!==t.type?e.push(t):tf(e,e=>"delete"===e.type).find(e=>"createIfNotExists"===e.type)||e.push(t),e),[])).flat().reduce((e,t)=>{let n=e[e.length-1];return n&&"patch"!==n.type||"patch"!==t.type?e.concat(t):e.slice(0,-1).concat({...t,patches:(n?.patches||[]).concat(t.patches)})},[])})})).map(e=>({...e,mutations:e.mutations.map(e=>"patch"!==e.type?e:{...e,patches:e.patches.reduce((e,t)=>{if("unset"!==t.op.type)return e.push(t),e;let n=e.filter(e=>{var n,r;return n=t.path,r=e.path,!(n.length<=r.length&&n.every((e,t)=>{var n;return n=function(e,t){if(t<0||t>=e.length)throw Error("Index out of bounds");return e[t]}(r,t),e5(e)&&e5(n)?e._key===n._key:"number"==typeof e?Number(e)===Number(n):e===n}))});return n.push(t),n},[]).reduceRight((e,t)=>(e.find(e=>{var n,r;return n=e.op,("set"===(r=t.op).type||"unset"===r.type)&&("set"===n.type||"unset"===n.type)&&th(e.path,t.path)})||e.unshift(t),e),[]).reduce((e,t)=>("setIfMissing"!==t.op.type?e.push(t):tf(e,e=>"unset"===e.op.type).find(e=>"setIfMissing"===e.op.type&&th(e.path,t.path))||e.push(t),e),[])})})).map(e=>({...e,mutations:e.mutations.map((e,n)=>{var r;return"patch"===e.type&&(r=t.get(e.id))?{...e,patches:ty(r,e.patches)}:e})})).map(e=>e.transaction&&void 0!==e.id?{id:e.id,mutations:e.mutations}:{mutations:e.mutations})}},onError:{target:"submitFailure"},onDone:{target:"pristine",actions:["restore stashed changes","reset submit attempts","send pristine event to parent"]}},tags:["busy","ready"]},submitFailure:{exit:["clear error from context"],after:{submitTransactionsTimeout:{actions:["increment submit attempts"],target:"submitting"}},on:{retry:"submitting"},tags:["error","ready"]}}},loadFailure:{exit:["clear error from context"],after:{fetchRemoteSnapshotTimeout:{actions:["increment fetch attempts"],target:"loading"}},on:{retry:"loading"},tags:["error"]}}}}});function tw(e,t,n){var r;let i=(r=function(e){if(!e)return null;let{_rev:t,...n}=e;return n}(e),new em(new eb,r,t).process());return i?Object.assign(i,{_rev:n}):null}let tx=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tE=/_key\s*==\s*['"](.*)['"]/,tk=/^\d*:\d*$/;function t_(e){return"number"==typeof e||"string"==typeof e&&/^\[\d+\]$/.test(e)}function tj(e){return"string"==typeof e?tE.test(e.trim()):"object"==typeof e&&"_key"in e}function tS(e){if("string"==typeof e&&tk.test(e))return!0;if(!Array.isArray(e)||2!==e.length)return!1;let[t,n]=e;return("number"==typeof t||""===t)&&("number"==typeof n||""===n)}function tI(e){if(!Array.isArray(e))throw Error("Path is not an array");return e.reduce((e,t,n)=>{let r=typeof t;if("number"===r)return`${e}[${t}]`;if("string"===r)return`${e}${0===n?"":"."}${t}`;if(tj(t)&&t._key)return`${e}[_key=="${t._key}"]`;if(Array.isArray(t)){let[n,r]=t;return`${e}[${n}:${r}]`}throw Error(`Unsupported path segment \`${JSON.stringify(t)}\``)},"")}function tA(e){if("string"!=typeof e)throw Error("Path is not a string");let t=e.match(tx);if(!t)throw Error("Invalid path string");return t.map(tO)}function tO(e){return t_(e)?Number(e.replace(/[^\d]/g,"")):tj(e)?{_key:e.match(tE)[1]}:tS(e)?function(e){let[t,n]=e.split(":").map(e=>""===e?e:Number(e));return[t,n]}(e):e}var tM=Object.freeze({__proto__:null,fromString:tA,get:function(e,t,n){let r="string"==typeof t?tA(t):t;if(!Array.isArray(r))throw Error("Path must be an array or a string");let i=e;for(let e=0;e<r.length;e++){let t=r[e];if(t_(t)){if(!Array.isArray(i))return n;i=i[t]}if(tj(t)){if(!Array.isArray(i))return n;i=i.find(e=>e._key===t._key)}if("string"==typeof t&&(i="object"==typeof i&&null!==i?i[t]:void 0),typeof i>"u")return n}return i},isIndexSegment:t_,isIndexTuple:tS,isKeySegment:tj,reKeySegment:tE,toString:tI});let tP="drafts.";function t$(e){return{lang:e?.lang??nj?.lang,message:e?.message,abortEarly:e?.abortEarly??nj?.abortEarly,abortPipeEarly:e?.abortPipeEarly??nj?.abortPipeEarly,skipPipe:e?.skipPipe}}function tC(e,t,n,r,i){var o,a,s,l;let u;let c=i&&"input"in i?i.input:n.value,p=i?.expected??e.expects,d=i?.received??("object"==(u=typeof c)&&(u=(c&&Object.getPrototypeOf(c)?.constructor?.name)??"null"),"string"===u?`"${c}"`:"number"===u||"bigint"===u||"boolean"===u?`${c}`:u),f={kind:e.kind,type:e.type,input:c,expected:p,received:d,message:`Invalid ${t}: ${p?`Expected ${p} but r`:"R"}eceived ${d}`,requirement:e.requirement,path:i?.path,issues:i?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly,skipPipe:r.skipPipe},h="schema"===e.kind,y=e.message??(o=e.reference,a=f.lang,nA?.get(o)?.get(a))??(h?(s=f.lang,nI?.get(s)):null)??r.message??(l=f.lang,nS?.get(l));y&&(f.message="function"==typeof y?y(f):y),h&&(n.typed=!1),n.issues?n.issues.push(f):n.issues=[f]}var tR=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function tT(e,t,n){return"function"==typeof e.fallback?e.fallback(t,n):e.fallback}function tL(e,t,n){return"function"==typeof e.default?e.default(t,n):e.default}function tD(e){if("entries"in e){let t={};for(let n in e.entries)t[n]=tD(e.entries[n]);return t}return"items"in e?e.items.map(tD):tL(e)}async function tF(e){return"entries"in e?Object.fromEntries(await Promise.all(Object.entries(e.entries).map(async([e,t])=>[e,await tF(t)]))):"items"in e?Promise.all(e.items.map(tF)):tL(e)}function tz(e){if("entries"in e){let t={};for(let n in e.entries)t[n]=tz(e.entries[n]);return t}return"items"in e?e.items.map(tz):tT(e)}async function tN(e){return"entries"in e?Object.fromEntries(await Promise.all(Object.entries(e.entries).map(async([e,t])=>[e,await tN(t)]))):"items"in e?Promise.all(e.items.map(tN)):tT(e)}function tU(e,t){return{kind:"schema",type:"object",reference:tU,expects:"Object",async:!1,entries:e,message:t,_run(e,t){let n=e.value;if(n&&"object"==typeof n)for(let r in e.typed=!0,e.value={},this.entries){let i=n[r],o=this.entries[r]._run({typed:!1,value:i},t);if(o.issues){let a={type:"object",origin:"value",input:n,key:r,value:i};for(let t of o.issues)t.path?t.path.unshift(a):t.path=[a],e.issues?.push(t);if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}o.typed||(e.typed=!1),(void 0!==o.value||r in n)&&(e.value[r]=o.value)}else tC(this,"type",e,t);return e}}}function tW(e,...t){let n={kind:"schema",type:"optional",reference:tW,expects:`${e.expects} | undefined`,async:!1,wrapped:e,_run(e,t){return void 0===e.value&&("default"in this&&(e.value=tL(this,e,t)),void 0===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function tV(e){return{kind:"schema",type:"string",reference:tV,expects:"string",async:!1,message:e,_run(e,t){return"string"==typeof e.value?e.typed=!0:tC(this,"type",e,t),e}}}function tB(e,t,n){let r=e._run({typed:!1,value:t},t$(n));return{typed:r.typed,success:!r.issues,output:r.value,issues:r.issues}}let tq=/^([\w-]+):(0|[1-9][0-9]*)$/,tG=/^([\w-]+):([0-9]+),([0-9]+)$/,tH=/^([\w-]+):([\w-]+)$/,tZ="drafts.",tK=function(...e){return{...e[0],pipe:e,_run(t,n){for(let r=0;r<e.length;r++){t=e[r]._run(t,n);let i=e[r+1];if(n.skipPipe||t.issues&&(n.abortEarly||n.abortPipeEarly||i?.kind==="schema"||i?.kind==="transformation")){t.typed=!1;break}}return t}}}(tV(),function e(t,n){return{kind:"validation",type:"min_length",reference:e,async:!1,expects:`>=${t}`,requirement:t,message:n,_run(e,t){return e.typed&&e.value.length<this.requirement&&tC(this,"length",e,t,{received:`${e.value.length}`}),e}}}(1)),tY=tW(tK),tX=tU({baseUrl:tK,dataset:tY,id:tK,path:tK,projectId:tY,tool:tY,type:tY,workspace:tY,isDraft:tW(tV())}),tJ=tU({origin:tK,href:tK,data:tW(function e(t,n,r){return{kind:"schema",type:"record",reference:e,expects:"Object",async:!1,key:t,value:n,message:r,_run(e,t){let n=e.value;if(n&&"object"==typeof n){for(let r in e.typed=!0,e.value={},n)if("__proto__"!==r&&"prototype"!==r&&"constructor"!==r){let i=n[r],o=this.key._run({typed:!1,value:r},t);if(o.issues){let a={type:"record",origin:"key",input:n,key:r,value:i};for(let t of o.issues)t.path=[a],e.issues?.push(t);if(e.issues||(e.issues=o.issues),t.abortEarly){e.typed=!1;break}}let a=this.value._run({typed:!1,value:i},t);if(a.issues){let o={type:"record",origin:"value",input:n,key:r,value:i};for(let t of a.issues)t.path?t.path.unshift(o):t.path=[o],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}o.typed&&a.typed||(e.typed=!1),o.typed&&(e.value[o.value]=a.value)}}else tC(this,"type",e,t);return e}}}(tV(),function e(){return{kind:"schema",type:"unknown",reference:e,expects:"unknown",async:!1,_run:e=>(e.typed=!0,e)}}()))});function tQ(e){let t=tB(tX,e);if(t.success)return t.output;let n=tB(tJ,e);if(n.success)try{let e=new URL(n.output.href,typeof document>"u"?"https://example.com":location.origin);return e.searchParams.size>0?function(e,t,n){let r=e._run({typed:!1,value:t},t$(void 0));if(r.issues)throw new tR(r.issues);return r.value}(tX,Object.fromEntries(e.searchParams.entries())):n.output}catch(e){return console.error("Failed to parse sanity node",e),n.output}}let t0=/_key\s*==\s*['"](.*)['"]/,t1=/^\d*:\d*$/;function t2(e){return"number"==typeof e||"string"==typeof e&&/^\[\d+\]$/.test(e)}function t3(e){return"string"==typeof e?t0.test(e.trim()):"object"==typeof e&&"_key"in e}let t8=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t4=/_key\s*==\s*['"](.*)['"]/;function t5(e,t,n){let r="string"==typeof t?function(e){if("string"!=typeof e)throw Error("Path is not a string");let t=e.match(t8);if(!t)throw Error("Invalid path string");return t.map(t7)}(t):t;if(!Array.isArray(r))throw Error("Path must be an array or a string");let i=e;for(let e=0;e<r.length;e++){let t=r[e];if(t2(t)){if(!Array.isArray(i))return n;i=i[t]}if(t3(t)){if(!Array.isArray(i))return n;i=i.find(e=>e._key===t._key)}if("string"==typeof t&&(i="object"==typeof i&&null!==i?i[t]:void 0),typeof i>"u")return n}return i}function t7(e){return t2(e)?Number(e.replace(/[^\d]/g,"")):t3(e)?{_key:e.match(t4)[1]}:!function(e){if("string"==typeof e&&t1.test(e))return!0;if(!Array.isArray(e)||2!==e.length)return!1;let[t,n]=e;return!("number"!=typeof t&&""!==t||"number"!=typeof n&&""!==n)}(e)?e:function(e){let[t,n]=e.split(":").map(e=>""===e?e:Number(e));return[t,n]}(e)}function t9(e){return e.startsWith(tZ)}function t6(e){return t9(e)?e:tZ+e}function ne(e){return t9(e)?e.slice(tZ.length):e}let nt=(0,e3.cY)({types:{},actions:{"emit sync event":(0,h.e)(({event:e})=>((0,e3.ZD)(e,"sync"),e)),"emit mutation event":(0,h.e)(({event:e})=>((0,e3.ZD)(e,"mutation"),e)),"emit rebased event":(0,h.e)(({event:e})=>((0,e3.ZD)(e,["rebased.local","rebased.remote"]),e)),"emit pristine event":(0,h.e)(({event:e})=>((0,e3.ZD)(e,["pristine"]),e)),"add document actor":(0,h.a)({documents:({context:e,event:t,spawn:n})=>{(0,e3.ZD)(t,"observe");let r=t.documentId;return e.documents[r]?e.documents:{...e.documents,[r]:n("documentMutatorMachine",{input:{id:r,client:e.client,sharedListener:e.sharedListener||tv(e.client)},id:r})}}}),"stop remote snapshot":(0,y.R)(({context:e,event:t})=>((0,e3.ZD)(t,"unobserve"),e.documents[t.documentId])),"remove remote snapshot from context":(0,h.a)({documents:({context:e,event:t})=>{if((0,e3.ZD)(t,"unobserve"),!e.documents[t.documentId])return e.documents;let{[t.documentId]:n,...r}=e.documents;return r}})},actors:{documentMutatorMachine:tb}}).createMachine({id:"dataset-mutator",context:({input:e})=>({documents:{},client:e.client,sharedListener:e.sharedListener}),on:{sync:{actions:["emit sync event"]},mutation:{actions:["emit mutation event"]},"rebased.*":{actions:["emit rebased event"]},pristine:{actions:["emit pristine event"]},observe:{actions:["add document actor"]},unobserve:{actions:["stop remote snapshot","remove remote snapshot from context"]}},initial:"pristine",states:{pristine:{}}}),nn=(0,f.ah)(),nr=nn,ni=new Set;function no(){let e=(0,d.useCallback)(e=>(ni.add(e),()=>ni.delete(e)),[]);return(0,d.useSyncExternalStore)(e,()=>nr,()=>nn)}function na(){let e=no();return(0,d.useMemo)(()=>e!==nn,[e])}function ns(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{e.apply(e,r)},t)}}function nl(e,t){let n=window.self!==window.top||window.opener;if(t===nn||!n)throw Error("The `useDocuments` hook cannot be used in this context");let r=t6(e),i=ne(e),o=t.getSnapshot().context?.documents,a=o?.[r],s=o?.[i],l=a||s;if(!l)throw Error(`Document "${e}" not found`);let u=a.getSnapshot().context?.local||s.getSnapshot().context?.local,c=new Promise(e=>{if(u)e(u);else{let t=l.on("ready",n=>{let{snapshot:r}=n;e(r||null),t.unsubscribe()})}});return{draftDoc:a,draftId:r,getSnapshot:()=>c,publishedDoc:s,publishedId:i,get snapshot(){if(!u)throw Error(`Snapshot for document "${e}" not found`);return u}}}function nu(){let e=no();return{getDocument:(0,d.useCallback)(t=>({id:t,commit:()=>{let{draftDoc:n}=nl(t,e);n.send({type:"submit"})},get:n=>{let{snapshot:r}=nl(t,e);return n?t5(r,n):r},getSnapshot:function(e,t){let{getSnapshot:n}=nl(e,t);return n}(t,e),patch:async(n,r)=>{let i=nl(t,e),{draftDoc:o,draftId:a,getSnapshot:s,publishedId:l}=i,{commit:u=!0}=r||{},c=await ("function"==typeof n?n({draftId:a,publishedId:l,get snapshot(){return i.snapshot},getSnapshot:s}):n),p=await s();if(!p)throw Error(`Snapshot for document "${t}" not found`);o.send({type:"mutate",mutations:[{type:"createIfNotExists",document:{...p,_id:a}},{type:"patch",id:a,patches:j(c)}]}),u&&("object"==typeof u&&"debounce"in u?ns(()=>o.send({type:"submit"}),u.debounce)():o.send({type:"submit"}))}}),[e]),mutateDocument:(0,d.useCallback)((t,n,r)=>{let{draftDoc:i}=nl(t,e),{commit:o=!0}=r||{};i.send({type:"mutate",mutations:n}),o&&("object"==typeof o&&"debounce"in o?ns(()=>i.send({type:"submit"}),o.debounce)():i.send({type:"submit"}))},[e])}}let nc=(()=>{let e;return()=>{if(e)return e;e=[];for(let t=0;t<256;++t)e[t]=(t+256).toString(16).slice(1);return e}})();function np(e){let t=nc();return(function(e=16){let t=new Uint8Array(e);return function(e){let t="undefined"!=typeof window&&"crypto"in window?window.crypto:globalThis.crypto;if(!t||!t.getRandomValues)throw Error("WebCrypto not available in this environment");t.getRandomValues(e)}(t),t})(e).reduce((e,n)=>e+t[n],"").slice(0,e)}function nd(e){let t,n;let r="string"==typeof e?e:e.path,i=r.lastIndexOf("."),o=r.substring(i+1,r.length);if(!o.indexOf("["))throw Error("Invalid path: not an array");let a=r.lastIndexOf("["),s=r.substring(0,a);if(o.includes("_key")){let e=o.indexOf('"')+1,r=o.indexOf('"',e);t=o.substring(e,r),n=!0}else{let e=o.indexOf("[")+1,r=o.indexOf("]",e);t=o.substring(e,r),n=!1}if(!s||!t)throw Error("Invalid path");return{path:s,key:t,hasExplicitKey:n}}async function nf(e,t,n){if(!e.type)throw Error("Node type is missing");let{path:r,key:i}=nd(e),o=await t.getSnapshot(),a=t5(o,r),s=t5(o,e.path),l=a.findIndex(e=>e._key===i),u=-1,c="before";if("first"===n){if(0===l)return[];u=0,c="before"}else if("last"===n){if(l===a.length-1)return[];u=-1,c="after"}else if("next"===n){if(l===a.length-1)return[];u=l,c="after"}else if("previous"===n){if(0===l)return[];u=l-1,c="before"}return[M(r,A(l,l+1)),M(r,I(s,c,u))]}for(var nh=n(63438),ny={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},ng={0:8203,1:8204,2:8205,3:65279},nm=[,,,,].fill(String.fromCodePoint(ng[0])).join(""),nv=Object.fromEntries(Object.entries(ng).map(e=>e.reverse())),nb=Object.fromEntries(Object.entries(ny).map(e=>e.reverse())),nw=`${Object.values(ny).map(e=>`\\u{${e.toString(16)}}`).join("")}`,nx=RegExp(`[${nw}]{4,}`,"gu"),nE=[],nk=0;nk<256;++nk)nE.push((nk+256).toString(16).slice(1));var n_,nj,nS,nI,nA,nO,nM=new Uint8Array(16),nP={randomUUID:"u">typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function n$(e){let t=e.getBoundingClientRect();return{x:t.x+scrollX,y:t.y+scrollY,w:t.width,h:t.height}}function nC(e,t,n){return"x"===n?{x:e.x+t,y:e.y,w:e.w-2*t,h:e.h}:{x:e.x,y:e.y+t,w:e.w,h:e.h-2*t}}function nR(e,t){return e.x===t.x&&e.y===t.y&&e.w===t.w&&e.h===t.h}function nT(e,t){let n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function nL(e,t,n){let r,i;let o={x:e.x1,y:e.y1};if(t.some(e=>(function(e,t){let n=e.x>=t.x&&e.x<=t.x+t.w,r=e.y>=t.y&&e.y<=t.y+t.h;return n&&r})(o,nC(e,Math.min(e.w,e.h)/10,"horizontal"===n?"x":"y"))))return null;for(let a of t){let t=function(e,t){let n=[{x1:t.x,y1:t.y,x2:t.x+t.w,y2:t.y},{x1:t.x+t.w,y1:t.y,x2:t.x+t.w,y2:t.y+t.h},{x1:t.x+t.w,y1:t.y+t.h,x2:t.x,y2:t.y+t.h},{x1:t.x,y1:t.y+t.h,x2:t.x,y2:t.y}],r=[];for(let t=0;t<n.length;t++){let i=function(e,t){let{x1:n,y1:r,x2:i,y2:o}=e,{x1:a,y1:s,x2:l,y2:u}=t;if(n===i&&r===o||a===l&&s===u)return!1;let c=(u-s)*(i-n)-(l-a)*(o-r);if(0===c)return!1;let p=((l-a)*(r-s)-(u-s)*(n-a))/c,d=((i-n)*(r-s)-(o-r)*(n-a))/c;return!(p<0)&&!(p>1)&&!(d<0)&&!(d>1)&&{x:n+p*(i-n),y:r+p*(o-r)}}(e,n[t]);if(i){let e=!1;for(let t=0;t<r.length;t++)r[t].x===i.x&&r[t].y===i.y&&(e=!0);e||r.push(i)}}return 0!==r.length&&r.sort((t,n)=>nT(t,{x:e.x1,y:e.y1})-nT(n,{x:e.x1,y:e.y1}))}(e,nC(a,Math.min(a.w,a.h)/10,"horizontal"===n?"x":"y"));if(t){let e=t[0];r?nT(o,e)<nT(o,r)&&(r=e,i=a):(r=e,i=a)}}return i||null}function nD(e,t,n){let{x:r,y:i,w:o,h:a}=e,{x:s,y:l}=n;return{x:s+(r-s)*t,y:l+(i-l)*t,w:o*t,h:a*t}}function nF(e){let t=Math.max(0,Math.min(...e.map(e=>e.y))),n=Math.min(document.body.scrollHeight,Math.max(...e.map(e=>e.y+e.h)));return{min:t,max:n,height:n-t}}function nz(e,t){return t.find(t=>nR(n$(t.elements.element),e))?.sanity}function nN(e,t,n){return Object.values(t).every(e=>null===e)?null:"horizontal"===n?{left:t.left?{rect:t.left,sanity:nz(t.left,e)}:null,right:t.right?{rect:t.right,sanity:nz(t.right,e)}:null}:{top:t.top?{rect:t.top,sanity:nz(t.top,e)}:null,bottom:t.bottom?{rect:t.bottom,sanity:nz(t.bottom,e)}:null}}function nU(e){let t=document.body.getBoundingClientRect();return{x:Math.max(t.x,Math.min(e.clientX,t.x+t.width)),y:e.clientY+window.scrollY}}function nW(e,t,n){let r=n$(t),i=[...t.querySelectorAll(":where(h1, h2, h3, h4, p, a, img, span, button):not(:has(*))")];e.x<=r.x&&(e.x=r.x),e.x>=r.x+r.w&&(e.x=r.x+r.w),e.y>=r.y+r.h&&(e.y=r.y+r.h),e.y<=r.y&&(e.y=r.y);let o=i.map(e=>{let t=nD(n$(e),n,{x:r.x,y:r.y});return{x:t.x-r.x,y:t.y-r.y,w:t.w,h:t.h,tagName:e.tagName}});return{offsetX:(r.x-e.x)*n,offsetY:(r.y-e.y)*n,w:r.w*n,h:r.h*n,maxWidth:r.w*n*.75,childRects:o}}function nV(e){let t=function(e){let t=Math.max(0,Math.min(...e.map(e=>e.x))),n=Math.min(document.body.offsetWidth,Math.max(...e.map(e=>e.x+e.w)));return{min:t,max:n,width:n-t}}(e),n=nF(e),r=t.min>8&&t.min+t.width<=window.innerWidth-8,i=n.min>8&&n.min+n.height<=document.body.scrollHeight-8,o=r&&i;return{x:o?t.min-8:t.min,y:o?n.min-8:n.min,w:o?t.width+16:t.width,h:o?n.height+16:n.height}}async function nB(e,t,n,r,i,o){return new Promise(a=>{if(1===new DOMMatrix(window.getComputedStyle(t).transform).a)return;let s=n-window.innerHeight,l=scrollY;(e-=window.innerHeight/2)<0&&(e=0),t.addEventListener("transitionend",()=>{t.style.transition="none",t.style.transform="none",scrollTo({top:e,behavior:"instant"}),setTimeout(()=>{r({type:"overlay/dragEndMinimapTransition"}),r({type:"overlay/dragToggleMinimap",display:!1})},2*i),a()},{once:!0}),r({type:"overlay/dragStartMinimapTransition"}),t.style.transform=`translateY(${Math.max(l-e,-s+l)}px) scale(1)`,o&&(document.body.style.overflow=o.body.overflow,document.body.style.height=o.body.height,document.documentElement.style.overflow=o.documentElement.overflow,document.documentElement.style.height=o.documentElement.height)})}let nq=!1,nG={x:0,y:0},nH={x:0,y:0},nZ=typeof document>"u"?0:document.documentElement.scrollHeight,nK=null,nY=e=>e instanceof HTMLElement||e instanceof SVGElement,nX=e=>e&&nY(e)?e.dataset?.sanityOverlayElement?e:nX(e.parentElement):null;function nJ(e,t=!1){return nx.lastIndex=0,nx.test(e)?function(e,t=!1){try{let n=function(e){let t=e.match(nx);if(t)return function(e,t=!1){let n=Array.from(e);if(n.length%2==0){if(n.length%4||!e.startsWith(nm))return function(e,t){var n;let r=[];for(let t=.5*e.length;t--;){let n=`${nb[e[2*t].codePointAt(0)]}${nb[e[2*t+1].codePointAt(0)]}`;r.unshift(String.fromCharCode(parseInt(n,16)))}let i=[],o=[r.join("")],a=10;for(;o.length;){let e=o.shift();try{if(i.push(JSON.parse(e)),t)break}catch(r){if(!a--)throw r;let t=+(null==(n=r.message.match(/\sposition\s(\d+)$/))?void 0:n[1]);if(!t)throw r;o.unshift(e.substring(0,t),e.substring(t))}}return i}(n,t)}else throw Error("Encoded data has invalid length");let r=[];for(let e=.25*n.length;e--;){let t=n.slice(4*e,4*e+4).map(e=>nv[e.codePointAt(0)]).join("");r.unshift(String.fromCharCode(parseInt(t,4)))}if(t){r.shift();let e=r.indexOf("\0");return -1===e&&(e=r.length),[JSON.parse(r.slice(0,e).join(""))]}return r.join("").split("\0").filter(Boolean).map(e=>JSON.parse(e))}(t[0],!0)[0]}(e);return n&&"sanity.io"===n.origin?(t&&(n.href=n.href?.replace(".alt","")),n):null}catch(t){return console.error("Failed to decode stega for string: ",e,"with the original error: ",t),null}}(e,t):null}let nQ=e=>e.nodeType===Node.ELEMENT_NODE,n0=e=>"IMG"===e.tagName,n1=e=>"TIME"===e.tagName,n2=e=>"SVG"===e.tagName.toUpperCase();function n3(e){return"path"in e}function n8(e){let t=e.lastIndexOf(".");return e.substring(t,e.length).includes("[")}function n4(e){if(!n8(e))return null;let t=e.split(".");return t[t.length-1]=t[t.length-1].replace(/\[.*?\]/g,"[]"),t.join(".")}function n5(e,t){return!(!n8(e.path)||!n8(t.path))&&n4(e.path)===n4(t.path)}function n7(e,t,n,r){if(!e.getAttribute("data-sanity")||e.getAttribute("data-sanity-drag-disable")||!t||!n3(t)||!n8(t.path))return null;let i=e.getAttribute("data-sanity-drag-group"),o=[...n].reduce((e,n)=>{let o=r.get(n),a=n.getAttribute("data-sanity-drag-disable"),s=n.getAttribute("data-sanity-drag-group"),l=null!==n.getAttribute("data-sanity");return o&&!a&&n3(o.sanity)&&n5(t,o.sanity)&&(null===i||i===s)&&l&&e.push(o),e},[]);return o.length<=1?null:o}let n9=(0,d.createContext)(null),n6=e=>"object"==typeof e&&null!=e&&1===e.nodeType,re=(e,t)=>(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e,rt=(e,t)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){let n=getComputedStyle(e,null);return re(n.overflowY,t)||re(n.overflowX,t)||(e=>{let t=(e=>{if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}})(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)})(e)}return!1},rn=(e,t,n,r,i,o,a,s)=>o<e&&a>t||o>e&&a<t?0:o<=e&&s<=n||a>=t&&s>=n?o-e-r:a>t&&s<n||o<e&&s>n?a-t+i:0,rr=e=>{let t=e.parentElement;return null==t?e.getRootNode().host||null:t},ri=(e,t)=>{var n,r,i,o;if("undefined"==typeof document)return[];let{scrollMode:a,block:s,inline:l,boundary:u,skipOverflowHiddenElements:c}=t,p="function"==typeof u?u:e=>e!==u;if(!n6(e))throw TypeError("Invalid target");let d=document.scrollingElement||document.documentElement,f=[],h=e;for(;n6(h)&&p(h);){if((h=rr(h))===d){f.push(h);break}null!=h&&h===document.body&&rt(h)&&!rt(document.documentElement)||null!=h&&rt(h,c)&&f.push(h)}let y=null!=(r=null==(n=window.visualViewport)?void 0:n.width)?r:innerWidth,g=null!=(o=null==(i=window.visualViewport)?void 0:i.height)?o:innerHeight,{scrollX:m,scrollY:v}=window,{height:b,width:w,top:x,right:E,bottom:k,left:_}=e.getBoundingClientRect(),{top:j,right:S,bottom:I,left:A}=(e=>{let t=window.getComputedStyle(e);return{top:parseFloat(t.scrollMarginTop)||0,right:parseFloat(t.scrollMarginRight)||0,bottom:parseFloat(t.scrollMarginBottom)||0,left:parseFloat(t.scrollMarginLeft)||0}})(e),O="start"===s||"nearest"===s?x-j:"end"===s?k+I:x+b/2-j+I,M="center"===l?_+w/2-A+S:"end"===l?E+S:_-A,P=[];for(let e=0;e<f.length;e++){let t=f[e],{height:n,width:r,top:i,right:o,bottom:u,left:c}=t.getBoundingClientRect();if("if-needed"===a&&x>=0&&_>=0&&k<=g&&E<=y&&x>=i&&k<=u&&_>=c&&E<=o)break;let p=getComputedStyle(t),h=parseInt(p.borderLeftWidth,10),j=parseInt(p.borderTopWidth,10),S=parseInt(p.borderRightWidth,10),I=parseInt(p.borderBottomWidth,10),A=0,$=0,C="offsetWidth"in t?t.offsetWidth-t.clientWidth-h-S:0,R="offsetHeight"in t?t.offsetHeight-t.clientHeight-j-I:0,T="offsetWidth"in t?0===t.offsetWidth?0:r/t.offsetWidth:0,L="offsetHeight"in t?0===t.offsetHeight?0:n/t.offsetHeight:0;if(d===t)A="start"===s?O:"end"===s?O-g:"nearest"===s?rn(v,v+g,g,j,I,v+O,v+O+b,b):O-g/2,$="start"===l?M:"center"===l?M-y/2:"end"===l?M-y:rn(m,m+y,y,h,S,m+M,m+M+w,w),A=Math.max(0,A+v),$=Math.max(0,$+m);else{A="start"===s?O-i-j:"end"===s?O-u+I+R:"nearest"===s?rn(i,u,n,j,I+R,O,O+b,b):O-(i+n/2)+R/2,$="start"===l?M-c-h:"center"===l?M-(c+r/2)+C/2:"end"===l?M-o+S+C:rn(c,o,r,h,S+C,M,M+w,w);let{scrollLeft:e,scrollTop:a}=t;A=0===L?0:Math.max(0,Math.min(a+A/L,t.scrollHeight-n/L+R)),$=0===T?0:Math.max(0,Math.min(e+$/T,t.scrollWidth-r/T+C)),O+=a-A,M+=e-$}P.push({el:t,top:A,left:$})}return P},ro=e=>!1===e?{block:"end",inline:"nearest"}:(e=>e===Object(e)&&0!==Object.keys(e).length)(e)?e:{block:"start",inline:"nearest"},ra=e=>{let t=(0,f.p4)(async({input:t,signal:n})=>{let{id:r}=t,{snapshot:i}=await e.fetch({type:"visual-editing/fetch-snapshot",data:{documentId:r}},{signal:n});return i}),n=(0,f.p4)(async({input:t})=>{let{transactions:n}=t;for(let t of n){let n=S.encodeTransaction(t);return e.post({type:"visual-editing/mutate",data:n})}});return tb.provide({actions:{"send sync event to parent":(0,h.b)(({enqueue:e})=>{e.sendParent(({context:e})=>({type:"sync",id:e.id,document:e.remote})),e.emit(({context:e})=>({type:"ready",snapshot:e.local}))})},actors:{"fetch remote snapshot":t,"submit mutations as transactions":n}})},rs=e=>{let{comlink:t,history:n}=e;return(0,d.useEffect)(()=>t?.on("presentation/navigate",e=>{n?.update(e)}),[t,n]),(0,d.useEffect)(()=>{if(n)return n.subscribe(e=>{e.title=e.title||document.title,t?.post({type:"visual-editing/navigate",data:e})})},[t,n]),null},rl=e=>{let{comlink:t}=e;return(0,d.useEffect)(()=>{let e=()=>{t.post({type:"visual-editing/meta",data:{title:document.title}})},n=new MutationObserver(([t])=>{"TITLE"===t.target.nodeName&&e()});return n.observe(document.head,{subtree:!0,characterData:!0,childList:!0}),e(),()=>n.disconnect()},[t]),null},ru=(0,d.createContext)(null);function rc(){let e=(0,d.useContext)(ru);if(!e)throw Error("Schema context is missing");return e}function rp(e,t,n,r){if(!e.type)throw Error("Node type is missing");return()=>t.patch(()=>(function(e,t,n){let{path:r,key:i}=nd(e);return[M(r,I([{_type:t,_key:np()}],n,{_key:i}))]})(e,n,r))}function rd(e){let{node:t,doc:n}=e;return n?[{type:"action",label:"Duplicate",icon:nh.C,action:function(e,t){if(!e.type)throw Error("Node type is missing");return()=>t.patch(async({getSnapshot:t})=>(function(e,t,n="after"){let{path:r,key:i}=nd(e);return[M(r,I({...t5(t,e.path),_key:np()},n,{_key:i}))]})(e,await t()))}(t,n)}]:[]}function rf(e){let{node:t,doc:n}=e;return n?[{type:"action",label:"Remove",icon:nh.R,action:function(e,t){if(!e.type)throw Error("Node type is missing");return()=>t.patch(async({getSnapshot:t})=>(function(e,t){let{path:n,key:r}=nd(e),i=t5(t,n).findIndex(e=>e._key===r);return[M(n,A(i,i+1))]})(e,await t()))}(t,n)}]:[]}async function rh(e,t=!0){let{node:n,doc:r}=e;if(!r)return[];let i=[],o=[],[a,s,l,u]=await Promise.all([nf(n,r,"previous"),nf(n,r,"next"),nf(n,r,"first"),nf(n,r,"last")]);return l.length&&o.push({type:"action",label:"To top",icon:nh.e,action:()=>r.patch(l)}),a.length&&o.push({type:"action",label:"Up",icon:nh.f,action:()=>r.patch(a)}),s.length&&o.push({type:"action",label:"Down",icon:nh.h,action:()=>r.patch(s)}),u.length&&o.push({type:"action",label:"To bottom",icon:nh.U,action:()=>r.patch(u)}),o.length&&(i.push({type:"group",label:"Move",icon:nh.S,items:o}),t&&i.push({type:"divider"})),i}let ry=e=>{let{label:t,parent:n,width:i,onSelect:o,boundaryElement:a}=e;return(0,r.jsx)(nh.M,{fontSize:1,icon:nh.b,padding:2,popover:{arrow:!1,constrainSize:!0,floatingBoundary:a,padding:0,placement:"right-start",fallbackPlacements:["left-start","right","left","right-end","left-end","bottom","top"],preventOverflow:!0,width:i,__unstable_margins:[4,4,4,4]},space:2,text:t,children:(0,r.jsx)(nh.c,{node:n,onSelect:o})})},rg=[-4,4,-4,4];function rm(e){let{node:t,onDismiss:n,boundaryElement:i}=e,o=(0,d.useCallback)(()=>{"action"===t.type&&(t.action?.(),n?.())},[t,n]);if("divider"===t.type)return(0,r.jsx)(nh.o,{});if("action"===t.type)return(0,r.jsx)(nh.p,{fontSize:1,hotkeys:t.hotkeys,icon:t.icon,padding:2,space:2,text:t.label,disabled:!t.action,onClick:o});if("group"===t.type)return(0,r.jsx)(nh.M,{fontSize:1,icon:t.icon,padding:2,popover:{arrow:!1,constrainSize:!0,placement:"right-start",fallbackPlacements:["left-start","right","left","right-end","left-end","bottom","top"],preventOverflow:!0,__unstable_margins:rg},space:2,text:t.label,children:t.items.map((e,t)=>(0,r.jsx)(rm,{node:e,onDismiss:n,boundaryElement:i},t))});if("custom"===t.type){let{component:e}=t;return(0,r.jsx)(e,{boundaryElement:i})}return null}let rv=e=>{let{node:t,onDismiss:n,position:{x:i,y:o}}=e,[a,s]=(0,d.useState)(null),{getField:l}=rc(),{getDocument:u}=nu(),{field:c,parent:p}=l(t),f=(0,d.useMemo)(()=>c?.title||c?.name||"Unknown type",[c]),h=(0,d.useMemo)(()=>(0,nh.g)(c),[c]),[y,g]=(0,d.useState)(void 0);(0,d.useEffect)(()=>{(async()=>{let e=u(t.id);e&&g(await function(e){let{node:t,field:n,parent:i,doc:o}=e;return"arrayItem"===n?.type?async function(e){let{node:t,field:n,doc:r}=e,i=[];return i.push(...rd(e)),i.push(...rf(e)),i.push(...await rh(e)),i.push({type:"action",label:"Insert before",icon:nh.a,action:rp(t,r,n.name,"before")}),i.push({type:"action",label:"Insert after",icon:nh.b,action:rp(t,r,n.name,"after")}),i}({node:t,field:n,doc:o}):"union"===i?.type?async function(e){let{doc:t,node:n,parent:i}=e,o=[];if(o.push(...rd(e)),o.push(...rf(e)),o.push(...await rh(e)),i.options?.insertMenu){let e=(i.options.insertMenu||{}).views?.some(e=>"grid"===e.name)?0:void 0;o.push({type:"custom",component:({boundaryElement:o})=>(0,r.jsx)(ry,{label:"Insert before",onSelect:e=>{rp(n,t,e.name,"before")()},parent:i,width:e,boundaryElement:o})}),o.push({type:"custom",component:({boundaryElement:o})=>(0,r.jsx)(ry,{label:"Insert after",onSelect:e=>{rp(n,t,e.name,"after")()},parent:i,width:e,boundaryElement:o})})}else o.push({type:"group",label:"Insert before",icon:nh.a,items:i.of.filter(e=>"unionOption"===e.type).map(e=>({type:"action",icon:(0,nh.g)(e),label:"block"===e.name?"Paragraph":e.title||e.name,action:rp(n,t,e.name,"before")}))}),o.push({type:"group",label:"Insert after",icon:nh.b,items:i.of.filter(e=>"unionOption"===e.type).map(e=>({type:"action",label:"block"===e.name?"Paragraph":e.title||e.name,icon:(0,nh.g)(e),action:rp(n,t,e.name,"after")}))});return o}({node:t,parent:i,doc:o}):Promise.resolve([])}({node:t,field:c,parent:p,doc:e}))})()},[c,t,p,u]);let m=(0,d.useMemo)(()=>({getBoundingClientRect:()=>({bottom:o,left:i,right:i,top:o,width:0,height:0})}),[i,o]);return(0,r.jsx)(nh.i,{setBoundaryElement:s,onDismiss:n,children:(0,r.jsx)(nh.j,{__unstable_margins:rg,arrow:!1,open:!0,placement:"right-start",referenceElement:m,content:(0,r.jsxs)(nh.k,{style:{minWidth:120,maxWidth:160},children:[(0,r.jsxs)(nh.F,{gap:2,padding:2,children:[(0,r.jsx)(nh.l,{flex:"none",children:y?(0,r.jsx)(nh.T,{size:1,children:h}):(0,r.jsx)(nh.m,{size:1})}),(0,r.jsx)(nh.n,{flex:1,space:2,children:(0,r.jsx)(nh.T,{size:1,weight:"semibold",children:y?f:"Loading..."})})]}),y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(nh.o,{}),y.map((e,t)=>(0,r.jsx)(rm,{node:e,onDismiss:n,boundaryElement:a},t))]})]}),children:(0,r.jsx)("div",{style:{position:"absolute",left:i,top:o}},`${i}-${o}`)})})},rb=(0,d.createContext)(null),rw=(0,nh.d)(nh.q)`
  background-color: var(--overlay-bg);
  border-radius: 3px;
  pointer-events: none;
  position: absolute;
  will-change: transform;
  box-shadow: var(--overlay-box-shadow);
  transition: none;

  --overlay-bg: transparent;
  --overlay-box-shadow: inset 0 0 0 1px transparent;

  [data-overlays] & {
    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));
    --overlay-box-shadow: inset 0 0 0 2px
      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));
  }

  [data-fading-out] & {
    transition:
      box-shadow 1550ms,
      background-color 1550ms;

    --overlay-bg: rgba(0, 0, 255, 0);
    --overlay-box-shadow: inset 0 0 0 1px transparent;
  }

  &[data-focused] {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  }

  &[data-hovered]:not([data-focused]) {
    transition: none;
    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);
  }

  /* [data-unmounted] & {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  } */

  :link {
    text-decoration: none;
  }
`,rx=(0,nh.d)(nh.F)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  right: 0;

  [data-hovered] & {
    pointer-events: all;
  }
`,rE=(0,nh.d)(nh.q)`
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;

  & [data-ui='Text'] {
    color: #fff;
    white-space: nowrap;
  }
`,rk=(0,nh.d)(nh.F)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  left: 0;
`,r_=(0,nh.d)(nh.F)`
  display: flex;
  align-items: center;
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;
  & [data-ui='Text'],
  & [data-sanity-icon] {
    color: #fff;
    white-space: nowrap;
  }
`,rj=e=>{let{element:t,focused:n,componentResolver:i,node:o,showActions:a,draggable:s}=e,{getField:l,getType:u}=rc(),c=u(o),{field:p,parent:f}=l(o),h="path"in o?function(e){let{id:t,type:n,path:r,baseUrl:i,tool:o,workspace:a}=e;return function(e){let{baseUrl:t,workspace:n="default",tool:r="default",id:i,type:o,path:a,projectId:s,dataset:l}=e;if(!t)throw Error("baseUrl is required");if(!a)throw Error("path is required");if(!i)throw Error("id is required");if("/"!==t&&t.endsWith("/"))throw Error("baseUrl must not end with a slash");let u="default"===n?void 0:n,c="default"===r?void 0:r,p=i.startsWith(tP)?i.slice(tP.length):i,d=Array.isArray(a)?tI(a.map(e=>{if("string"==typeof e||"number"==typeof e)return e;if(""!==e._key)return{_key:e._key};if(-1!==e._index)return e._index;throw Error(`invalid segment:${JSON.stringify(e)}`)})):a,f=new URLSearchParams({baseUrl:t,id:p,type:o,path:d});u&&f.set("workspace",u),c&&f.set("tool",c),s&&f.set("projectId",s),l&&f.set("dataset",l),i.startsWith(tP)&&f.set("isDraft","");let h=["/"===t?"":t];u&&h.push(u);let y=["mode=presentation",`id=${p}`,`type=${o}`,`path=${encodeURIComponent(d)}`];return c&&y.push(`tool=${c}`),h.push("intent","edit",`${y.join(";")}?${f}`),h.join("/")}({baseUrl:i,workspace:a,tool:o,type:n,id:t,path:function(e){let t="";for(let n of e)"string"!=typeof n?"number"!=typeof n?null!==n&&Array.isArray(n)?(t&&(t+=":"),t+=`${n.join(",")}}`):n._key&&(t&&(t+=":"),t+=`${n._key}`):(t&&(t+=":"),t+=`${n}`):(t&&(t+="."),t+=n);return t}(tM.fromString(r))})}(o):o.href,y=function(){let e=(0,d.useContext)(rb);if(!e)throw Error("Preview Snapshots context is missing");return e}(),g=(0,d.useMemo)(()=>{if("path"in o)return y.find(e=>e._id===o.id)?.title},[o,y]),m=(0,d.useMemo)(()=>c?.icon?(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:c.icon}}):(0,r.jsx)(nh.D,{}),[c?.icon]),v=(0,d.useMemo)(()=>{if(!("path"in o)||!p||!c)return;let e=p.value.type;return{document:c,element:t,field:p,focused:!!n,node:o,parent:f,type:e}},[c,t,p,n,o,f]),b=(0,d.useMemo)(()=>{if(!v)return;let e=i?.(v);return e?(0,d.isValidElement)(e)?e:(Array.isArray(e)?e:[e]).map(e=>"object"==typeof e&&"component"in e?e:{component:e,props:{}}):void 0},[i,v]);return(0,r.jsxs)(r.Fragment,{children:[a?(0,r.jsx)(rx,{gap:1,paddingBottom:1,"data-sanity-overlay-element":!0,children:(0,r.jsx)(rI,{href:h})}):null,g&&(0,r.jsx)(rk,{gap:1,paddingBottom:1,children:(0,r.jsxs)(r_,{gap:2,padding:2,children:[s&&(0,r.jsx)(nh.l,{marginRight:1,children:(0,r.jsx)(nh.T,{className:"drag-handle",size:0,children:(0,r.jsx)(nh.r,{})})}),(0,r.jsx)(nh.T,{size:0,children:m}),(0,r.jsx)(nh.T,{size:1,weight:"medium",children:g})]})}),Array.isArray(b)?b.map(({component:e,props:t},n)=>(0,r.jsx)(e,{PointerEvents:nh.P,...v,...t},n)):b]})},rS=(0,d.memo)(function(e){let{focused:t,hovered:n,rect:i,wasMaybeCollapsed:o,enableScrollIntoView:a}=e,s=(0,d.useRef)(null),l=(0,d.useRef)(!1),u=(0,d.useMemo)(()=>({width:`${i.w}px`,height:`${i.h}px`,transform:`translate(${i.x}px, ${i.y}px)`}),[i]);return(0,d.useEffect)(()=>{if(!l.current&&!o&&!0===t&&s.current&&a){let e=s.current;(function(e,t){if(!e.isConnected||!(e=>{let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1})(e))return;let n=(e=>{let t=window.getComputedStyle(e);return{top:parseFloat(t.scrollMarginTop)||0,right:parseFloat(t.scrollMarginRight)||0,bottom:parseFloat(t.scrollMarginBottom)||0,left:parseFloat(t.scrollMarginLeft)||0}})(e);if("object"==typeof t&&"function"==typeof t.behavior)return t.behavior(ri(e,t));let r="boolean"==typeof t||null==t?void 0:t.behavior;for(let{el:i,top:o,left:a}of ri(e,ro(t))){let e=o-n.top+n.bottom,t=a-n.left+n.right;i.scroll({top:e,left:t,behavior:r})}})(s.current,{behavior:t=>{0!==t.length&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},scrollMode:"if-needed",block:"center",inline:"nearest"})}l.current=!0===t},[t,o,a]),(0,r.jsx)(rw,{"data-focused":t?"":void 0,"data-hovered":n?"":void 0,ref:s,style:u,children:n&&(0,r.jsx)(rj,{...e})})}),rI=(0,d.memo)(function(e){let t=(0,d.useSyncExternalStore)((0,d.useCallback)(e=>{let t=()=>e();return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)},[]),()=>window.location.href),n=(0,d.useMemo)(()=>{try{let n=new URL(e.href,typeof location>"u"?void 0:location.origin);return n.searchParams.set("preview",t),n.toString()}catch{return e.href}},[e.href,t]);return(0,r.jsx)(nh.l,{as:"a",href:n,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(rE,{padding:2,children:(0,r.jsx)(nh.T,{size:1,weight:"medium",children:"Open in Studio"})})})}),rA=({dragGroupRect:e})=>(0,r.jsx)("div",{style:{position:"absolute",top:`${e.y}px`,left:`${e.x}px`,width:e.w-1+"px",height:e.h-1+"px",border:"1px dashed #f0709b",pointerEvents:"none"}}),rO=({dragInsertPosition:e})=>{if(null===e)return;let t=0,n=0,i=0,o=0;if("horizontal"==(e?.left||e?.right?"horizontal":"vertical")){let{left:r,right:a}=e;if(i=6,a&&r){let e=r.rect.x+r.rect.w,i=a.rect.x,s=.0125*Math.min(a.rect.h,r.rect.h);t=.5*e+.5*i-3,n=r.rect.y+s,o=Math.min(a.rect.h,r.rect.h)-2*s}else if(a&&!r){let e=.0125*a.rect.h;t=a.rect.x-3,n=a.rect.y+e,o=a.rect.h-2*e}else if(r&&!a){let e=.0125*r.rect.h;t=r.rect.x+r.rect.w-3,n=r.rect.y+e,o=r.rect.h-2*e}}else{let{bottom:r,top:a}=e;if(r&&a){let e=Math.min(a.rect.x,r.rect.x),s=a.rect.y+a.rect.h,l=r.rect.y,u=.0125*Math.min(r.rect.w,a.rect.w);o=6,t=e+u,n=.5*s+.5*l-3,i=Math.max(r.rect.w,a.rect.w)-2*u}else if(r&&!a){let e=.0125*r.rect.w;t=r.rect.x+e,n=r.rect.y-3,i=r.rect.w-2*e,o=6}else if(a&&!r){let e=.0125*a.rect.w;t=a.rect.x+e,n=a.rect.y+a.rect.h-3,i=a.rect.w-2*e,o=6}}return(0,r.jsx)("div",{style:{position:"absolute",width:`${i}px`,height:`${o}px`,transform:`translate(${t}px, ${n}px)`,background:"#556bfc",border:"2px solid white",borderRadius:"999px",zIndex:"999999"}})},rM=nh.d.div`
  --drag-preview-opacity: 0.98;
  --drag-preview-skeleton-stroke: #ffffff;

  @media (prefers-color-scheme: dark) {
    --drag-preview-skeleton-stroke: #383d51;
  }

  position: fixed;
  display: grid;
  transform: ${({$scaleFactor:e,$width:t,$height:n})=>`translate(calc(var(--drag-preview-x) - ${t/2}px), calc(var(--drag-preview-y) - ${n/2}px)) scale(${e})`};
  width: ${({$width:e})=>`${e}px`};
  height: ${({$height:e})=>`${e}px`};
  z-index: 9999999;
  opacity: var(--drag-preview-opacity);
  cursor: move;

  .drag-preview-content-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    container-type: inline-size;
  }

  [data-ui='card'] {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .drag-preview-skeleton {
    position: absolute;
    inset: 0;

    rect {
      stroke: var(--drag-preview-skeleton-stroke);
    }
  }

  .drag-preview-handle {
    position: absolute;
    top: 4cqmin;
    left: 4cqmin;
    width: 6cqmin;
    fill: var(--drag-preview-handle-fill);
  }
`,rP=({skeleton:e})=>{var t,n;let i=Math.min(e.maxWidth,window.innerWidth/2),o=e.w>i?i/e.w:1,a=e.offsetX*o,s=e.offsetY*o,l=(0,nh.u)(),u=(0,nh.s)(),c=u.radius[~~((n=(e.w-0)*((t=u.radius.length-2)-1)/1920+1)<1?1:n>t?t:n)],p=e.childRects.filter(e=>"IMG"===e.tagName),d=e.childRects.filter(e=>"IMG"!==e.tagName);return(0,r.jsx)(rM,{$width:e.w,$height:e.h,$offsetX:a,$offsetY:s,$scaleFactor:o,children:(0,r.jsx)(nh.q,{radius:c,shadow:4,overflow:"hidden",tone:"transparent",scheme:l?"dark":"light",children:(0,r.jsx)("div",{className:"drag-preview-content-wrapper",children:(0,r.jsx)("svg",{className:"drag-preview-skeleton",viewBox:`0 0 ${e.w} ${e.h}`,children:[...p,...d].map((e,t)=>(0,r.jsx)("rect",{x:e.x,y:e.y,width:e.w,height:e.h,fill:u.color.skeleton.from},t))})})})})},r$=(0,nh.d)(nh.q)`
  position: fixed;
  bottom: 2rem;
  left: 2rem;
`,rC=()=>(0,r.jsx)(r$,{padding:2,shadow:2,radius:2,style:{zIndex:"999999"},children:(0,r.jsxs)(nh.F,{align:"center",gap:2,children:[(0,r.jsx)(nh.H,{keys:["Shift"]}),(0,r.jsx)(nh.T,{size:1,children:"Zoom Out"}),(0,r.jsx)(nh.E,{})]})}),rR=(e,t)=>{let{type:n}=t;switch(n){case"element/register":return e.find(e=>e.id===t.id)?e:[...e,{id:t.id,activated:!1,element:t.element,focused:!1,hovered:!1,rect:t.rect,sanity:t.sanity,dragDisabled:t.dragDisabled}];case"element/activate":return e.map(e=>e.id===t.id?{...e,activated:!0}:e);case"element/update":return e.map(e=>e.id===t.id?{...e,sanity:t.sanity,rect:t.rect}:e);case"element/unregister":return e.filter(e=>e.id!==t.id);case"element/deactivate":return e.map(e=>e.id===t.id?{...e,activated:!1,hovered:!1}:e);case"element/mouseenter":return e.map(e=>e.id===t.id?{...e,rect:t.rect,hovered:!0}:{...e,hovered:!1});case"element/mouseleave":return e.map(e=>e.id===t.id?{...e,hovered:!1}:e);case"element/updateRect":return e.map(e=>e.id===t.id?{...e,rect:t.rect}:e);case"element/click":return e.map(e=>({...e,focused:e.id===t.id&&"clicked"}));case"overlay/blur":case"presentation/blur":return e.map(e=>({...e,focused:!1}));case"presentation/focus":{let n=e.find(e=>"clicked"===e.focused);return e.map(e=>{let r="path"in e.sanity&&e.sanity.id===t.data.id&&e.sanity.path===t.data.path;return n&&e===n&&r?e:{...e,focused:r&&n?"duplicate":r}})}default:return e}};function rT(e,t){let{type:n}=t,{contextMenu:r,focusPath:i,perspective:o,isDragging:a,dragInsertPosition:s,dragShowMinimap:l,dragShowMinimapPrompt:u,dragSkeleton:c,dragMinimapTransition:p,dragGroupRect:d}=e,f=!1;if("presentation/focus"===n){let n=e.focusPath;n!==(i=t.data.path)&&(f=n.slice(i.length).startsWith("["))}return"presentation/perspective"===n&&(o=t.data.perspective),"element/contextmenu"===n&&(r="sanity"in t?{node:t.sanity,position:t.position}:null),("element/click"===n||"element/mouseleave"===n||"overlay/blur"===n||"presentation/blur"===n||"presentation/focus"===n)&&(r=null),"overlay/dragUpdateInsertPosition"===n&&(s=t.insertPosition),"overlay/dragStart"===n&&(a=!0),"overlay/dragUpdateSkeleton"===t.type&&(c=t.skeleton),"overlay/dragEnd"===n&&(a=!1),"overlay/dragToggleMinimapPrompt"===t.type&&(u=t.display),"overlay/dragStartMinimapTransition"===n&&(p=!0),"overlay/dragEndMinimapTransition"===n&&(p=!1),"overlay/dragUpdateGroupRect"===n&&(d=t.groupRect),"overlay/dragToggleMinimap"===n&&(l=t.display),{...e,contextMenu:r,elements:rR(e.elements,t),dragInsertPosition:s,dragSkeleton:c,dragGroupRect:d,isDragging:a,focusPath:i,perspective:o,wasMaybeCollapsed:f,dragShowMinimap:l,dragShowMinimapPrompt:u,dragMinimapTransition:p}}let rL=function(e){let{comlink:t,children:n}=e,[i,o]=(0,d.useState)([]);(0,d.useEffect)(()=>t?.on("presentation/preview-snapshots",e=>{o(e.snapshots)}),[t]);let a=(0,d.useMemo)(()=>i,[i]);return(0,r.jsx)(rb.Provider,{value:a,children:n})};function rD(e){return"document"===e.type}function rF(e){return"type"===e.type}let rz=function(e){let{comlink:t,children:n,elements:i}=e,[o,a]=(0,d.useState)(new Map),[s,l]=(0,d.useState)(null),u=(0,d.useCallback)(async e=>{if(t)try{let n=await t.fetch({type:"visual-editing/schema",data:void 0},{signal:e,suppressWarnings:!0});l(n.schema)}catch{}},[t]);(0,d.useEffect)(()=>{let e=new AbortController;return u(e.signal),()=>e.abort()},[u]);let c=(0,d.useCallback)(async(e,n)=>{if(e.length&&t)try{let r=await t.fetch({type:"visual-editing/schema-union-types",data:{paths:e}},{signal:n,suppressWarnings:!0});a(r.types),p.current=e}catch{}},[t]),p=(0,d.useRef)([]);(0,d.useEffect)(()=>{let e=new AbortController,t=i.reduce((e,t)=>{let{sanity:n}=t;if(!("id"in n)||!n.path.includes("[_key=="))return e;let r=n.path.split(".").toReversed().reduce((e,t)=>e.length?[t,...e]:t.includes("[_key==")?[t]:[],[]).join(".");return e.find(e=>e.id===n.id&&e.path===r)||e.push({id:n.id,path:r}),e},[]);return t.some(e=>!p.current.find(({id:t,path:n})=>t===e.id&&n===e.path))&&c(t,e.signal),()=>e.abort()},[i,c]);let f=(0,d.useCallback)((e,t="document")=>{if(!s||"string"!=typeof e&&(!("path"in e)||!Array.isArray(s)))return;let n="string"==typeof e?e:e.type;return s.filter("document"===t?rD:rF).find(e=>e.name===n)},[s]),h=(0,d.useCallback)(e=>{if(!("path"in e))return{field:void 0,parent:void 0};let t=f(e);if(!t)return{field:void 0,parent:void 0};let n=e.path.split(".").flatMap(e=>e.includes("[")?e.split(/(\[.+\])/,2):[e]);try{return function t(n,r,i,a=[]){if(!n)return{field:void 0,parent:void 0};let[s,...l]=r;if("fields"in n){let e=n.fields[s];if(!e&&"rest"in n)return t(n.rest,r,n,a);if(!l.length)return{field:e,parent:i};if(!e)throw Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...a,...r].join(".")}"`);return t(e.value,l,n,[...a,s])}if("array"===n.type)return t(n.of,r,n,a);if("arrayItem"===n.type)return l.length?t(n.value,l,n,[...a,s]):{field:n,parent:i};if("union"===n.type){let r=s.startsWith("[_key==")?o?.get(e.id)?.get([a.join("."),s].filter(Boolean).join("")):s;return t(n.of.find(e=>"unionOption"===e.type?e.name===r:e),l,n,[...a,s])}if("unionOption"===n.type)return s?t(n.value,r,n,a):{field:n,parent:i};if("inline"===n.type)return t(f(n.name,"type").value,r,n,a);throw Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...a,...r].join(".")}"`)}(t,n,void 0)}catch(e){return e instanceof Error&&console.warn(e.message),{field:void 0,parent:void 0}}},[f,o]),y=(0,d.useMemo)(()=>({getField:h,getType:f,resolvedTypes:o,schema:s||[]}),[h,f,o,s]);return(0,r.jsx)(ru.Provider,{value:y,children:n})},rN=(e=>{let t=e,n=new Set;return{getState:()=>t,setState:e=>{t=e(t),n.forEach(e=>e())},subscribe:e=>(n.add(e),()=>n.delete(e))}})({}),rU=e=>{let{comlink:t,children:n}=e;(0,d.useEffect)(()=>t?.on("presentation/shared-state",e=>{"value"in e?rN.setState(t=>({...t,[e.key]:e.value})):rN.setState(t=>{let{[e.key]:n,...r}=t;return r})}),[t]),(0,d.useEffect)(()=>{(async()=>{try{let e=await t?.fetch({type:"visual-editing/shared-state",data:void 0},{suppressWarnings:!0});e&&rN.setState(()=>e.state)}catch{console.warn("[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `@sanity/presentation` is up-to-date")}})()},[t]);let i=(0,d.useMemo)(()=>({comlink:t,store:rN}),[t]);return(0,r.jsx)(n9.Provider,{value:i,children:n})},rW=nh.d.div`
  background-color: transparent;
  direction: ltr;
  inset: 0;
  pointer-events: none;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${({$zIndex:e})=>e??"9999999"};
`;function rV(e){let t,n;return t=requestAnimationFrame(()=>{n=requestAnimationFrame(e)}),()=>{void 0!==t&&cancelAnimationFrame(t),void 0!==n&&cancelAnimationFrame(n)}}let rB=e=>{let{documentIds:t}=e,[n,r]=(0,d.useState)([]);(0,d.useEffect)(()=>{r(e=>{let n=Array.from(new Set(t));return e.length===n.length&&0===e.reduce((e,t)=>e.filter(e=>e!==t),n)?.length?e:n})},[t]);let i=no();return(0,d.useEffect)(()=>{for(let e of n)i.send({type:"observe",documentId:t6(e)}),i.send({type:"observe",documentId:ne(e)});return()=>{for(let e of n)i.send({type:"unobserve",documentId:t6(e)}),i.send({type:"unobserve",documentId:ne(e)})}},[i,n]),null},rq=e=>{let{comlink:t,dispatch:n,inFrame:r,onDrag:i,overlayEnabled:o,rootElement:a}=e,{dispatchDragEndEvent:s}=function(){let{getDocument:e}=nu();return(0,d.useEffect)(()=>{let t=t=>{let{insertPosition:n,target:r,preventInsertDefault:i}=t.detail;if(i)return;let o=function(e){if(e){let{top:t,right:n,bottom:r,left:i}=e;if(i||t)return{node:(i??t).sanity,position:"after"};if(n||r)return{node:(n??r).sanity,position:"before"}}}(n);if(o){let t=e(r.id),{node:n,position:i}=o,{key:a,hasExplicitKey:s}=nd(r),{path:l,key:u}=nd(n);l&&u&&u!==a&&t.patch(async({getSnapshot:e})=>{let t=t5(await e(),r.path);return s?[M(l,O({_key:a})),M(l,I(t,i,{_key:u}))]:[M(l,O(~~a)),M(l,I(t,i,u>a?~~u-1:~~u))]})}};return window.addEventListener("sanity/dragEnd",t),()=>{window.removeEventListener("sanity/dragEnd",t)}},[e]),{dispatchDragEndEvent:(0,d.useCallback)(e=>{let t=new CustomEvent("sanity/dragEnd",{detail:e,cancelable:!0});window.dispatchEvent(t)},[])}}(),l=function(e,t,n){let r=(0,d.useRef)(),i=na();return(0,d.useEffect)(()=>{if(e)return r.current=function({handler:e,overlayElement:t,inFrame:n,optimisticActorReady:r}){let i=!1,o=new Map,a=new WeakMap,s=new Set,l=new WeakMap,u,c,p,d=!1,f=[],h=()=>f[f.length-1];function y(e,t){e.removeEventListener("click",t.click,{capture:!0}),e.removeEventListener("contextmenu",t.contextmenu,{capture:!0}),e.removeEventListener("mousemove",t.mousemove,{capture:!0}),e.removeEventListener("mousedown",t.mousedown,{capture:!0}),e.removeEventListener("mouseenter",t.mouseenter),e.removeEventListener("mouseleave",t.mouseleave)}function g({id:t,elements:n,handlers:r}){let{element:i,measureElement:o}=n;i.addEventListener("click",r.click,{capture:!0}),i.addEventListener("contextmenu",r.contextmenu,{capture:!0}),i.addEventListener("mousemove",r.mousemove,{once:!0,capture:!0}),i.addEventListener("mousedown",r.mousedown,{capture:!0}),u.observe(o),e({type:"element/activate",id:t})}function m({id:t,elements:n,handlers:r}){let{element:i,measureElement:o}=n;y(i,r),u.unobserve(o),f=f.filter(e=>e!==i),e({type:"element/deactivate",id:t})}function v(){if(!n||!r)return;let t=h();if(!t)return;let i=a.get(t)?.sanity;if(!i||!n3(i))return;let o=n7(t,i,s,a)?"move":"auto";e({type:"overlay/setCursor",element:t,cursor:o})}function b(u){for(let p of function e(t){let n=[];function r(e,t){let r=function(e){if("object"==typeof e&&null!==e)return tQ(e);try{return tQ(JSON.parse(e))}catch{return function(e){var t;let n=e.split(";").reduce((e,t)=>{let[n,r]=t.split("=");if(!n||t.includes("=")&&!r)return e;switch(n){case"id":e.id=r;break;case"type":e.type=r;break;case"path":e.path=tM.toString(function(e){let t=[];for(let n of e.split(".")){let e=tq.exec(n);if(e){t.push(e[1],Number(e[2]));continue}let r=tG.exec(n);if(r){t.push(r[1],[Number(r[2]),Number(r[3])]);continue}let i=tH.exec(n);i?t.push(i[1],{_key:i[2]}):t.push(n)}return t}(r));break;case"base":e.baseUrl=decodeURIComponent(r);break;case"tool":e.tool=r;break;case"workspace":e.workspace=r;break;case"projectId":e.projectId=r;break;case"dataset":e.dataset=r;break;case"isDraft":e.isDraft=""}return e},{});if(t=n,!tX._run({typed:!1,value:t},{abortEarly:!0}).issues)return n}(e)}}(t);if(!r)return;let i=function e(t){let{display:n}=window.getComputedStyle(t);if("inline"!==n)return t;let r=t.parentElement;return r?e(r):null}(e);i&&n.push({elements:{element:e,measureElement:i},sanity:r})}if(t)for(let i of t.childNodes){let{nodeType:t,parentElement:o,textContent:a}=i;if(nQ(i)&&void 0!==i.dataset?.sanityEditTarget){let t=e(i).map(({sanity:e})=>e);if(!t.map(e=>n3(e)).every((e,t,n)=>e===n[0]))continue;let r=function(e){if(!e.length||!e.map(e=>n3(e)).every((e,t,n)=>e===n[0]))return;if(!n3(e[0]))return e[0];let t=e.filter(n3),n=e[0],r=["projectId","dataset","id","baseUrl","workspace","tool"];for(let e=1;e<t.length;e++){let i=t[e];if(r.some(e=>i[e]!==n?.[e])){n=void 0;break}n.path=function(e,t){let n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length);return n=n.slice(0,i).reverse(),r=r.slice(0,i).reverse(),n.reduce((e,t,n)=>t===r[n]?[...e,t]:[],[]).reverse().join(".")}(n.path,i.path)}return n}(t);r&&n.push({elements:{element:i,measureElement:i},sanity:r})}else if(t===Node.TEXT_NODE&&o&&a){let e=nJ(a);if(!e)continue;r(o,e)}else if(nQ(i)){if("SCRIPT"===i.tagName||"sanity-visual-editing"===i.id)continue;if(i.dataset?.sanity)r(i,i.dataset.sanity);else if(i.dataset?.sanityEditInfo)r(i,i.dataset.sanityEditInfo);else{if(n0(i)){let e=nJ(i.alt,!0);if(!e)continue;r(i,e);continue}if(n1(i)){let e=nJ(i.dateTime,!0);if(!e)continue;r(i,e)}else if(n2(i)){if(!i.ariaLabel)continue;let e=nJ(i.ariaLabel,!0);if(!e)continue;r(i,e)}}n.push(...e(i))}}return n}(u)){let{element:u}=p.elements;a.has(u)?function({elements:t,sanity:n}){let{element:r}=t,i=a.get(r);i&&(a.set(r,{...i,sanity:n}),e({type:"element/update",id:i.id,rect:n$(r),sanity:n}))}(p):function({elements:u,sanity:p}){let{element:y,measureElement:m}=u,b={click(t){let r=t.target;if(y===h()&&y.contains(r)){n&&(t.preventDefault(),t.stopPropagation());let r=a.get(y)?.sanity;r&&!d&&e({type:"element/click",id:w,sanity:r})}},contextmenu(t){if(!("path"in p&&n&&r&&p.path.split(".").pop()?.includes("[_key==")))return;let i=t.target;y===h()&&y.contains(i)&&(n&&(t.preventDefault(),t.stopPropagation()),e({type:"element/contextmenu",id:w,position:{x:t.clientX,y:t.clientY},sanity:p}))},mousedown(t){if(t.preventDefault(),t.currentTarget!==f.at(-1)||y.getAttribute("data-sanity-drag-disable")||!n||!r)return;let i=a.get(y)?.sanity;if(!i||!n3(i)||!n8(i.path))return;let o=n7(y,p,s,a);o&&function(e){var t;let{mouseEvent:n,element:r,overlayGroup:i,handler:o,target:a,onSequenceStart:s,onSequenceEnd:l}=e;if(0!==n.button)return;window.focus();let u=i.map(e=>n$(e.elements.element)),c=r.getAttribute("data-sanity-drag-flow")||((t=u).some(e=>t.filter(t=>!nR(e,t)).some(t=>e.y===t.y))?"horizontal":"vertical"),p=r.getAttribute("data-sanity-drag-group"),d=!!r.getAttribute("data-sanity-drag-minimap-disable"),f=!!r.getAttribute("data-sanity-drag-prevent-default"),h=r.getAttribute("data-unstable_sanity-drag-document-height"),y=r.getAttribute("data-unstable_sanity-drag-group-height"),g=null,m=nU(n),v=document.body,{minYScaled:b,scaleFactor:w}=function(e,t){let n=t||nF(e).height,r=(n+=200)>window.innerHeight?window.innerHeight/n:1,{min:i}=nF(e.map(e=>nD(e,r,{x:window.innerWidth/2,y:0})));return{scaleFactor:r,minYScaled:i-100*r}}(u,y?~~y:null),x=!1,E=!1,k=!0;nq||(nK={body:{overflow:window.getComputedStyle(document.body).overflow,height:window.getComputedStyle(document.body).height},documentElement:{overflow:window.getComputedStyle(document.documentElement).overflow,height:window.getComputedStyle(document.documentElement).height}},nZ=h?~~h:document.documentElement.scrollHeight);let _=setInterval(()=>{u=i.map(e=>n$(e.elements.element))},150),j=()=>{w>=1||(o({type:"overlay/dragUpdateSkeleton",skeleton:nW(nH,r,w)}),o({type:"overlay/dragToggleMinimapPrompt",display:!1}),o({type:"overlay/dragToggleMinimap",display:!0}),nq=!0,(async function(e,t,n,r,i){return new Promise(i=>{e.addEventListener("transitionend",()=>{setTimeout(()=>{r({type:"overlay/dragEndMinimapTransition"})},300),i()},{once:!0}),r({type:"overlay/dragStartMinimapTransition"}),r({type:"overlay/dragToggleMinimap",display:!0}),document.body.style.overflow="hidden",document.body.style.height="100%",document.documentElement.style.overflow="initial",document.documentElement.style.height="100%",setTimeout(()=>{e.style.transformOrigin="50% 0px",e.style.transition="transform 150ms ease",e.style.transform=`translate3d(0px, ${-n+scrollY}px, 0px) scale(${t})`},25)})})(v,w,b,o,0).then(()=>{setTimeout(()=>{o({type:"overlay/dragUpdateGroupRect",groupRect:nV(u)})},300)}))},S=e=>{Math.abs(e.deltaY)>=10&&w<1&&!nq&&!E&&!d&&k&&(o({type:"overlay/dragToggleMinimapPrompt",display:!0}),E=!0),!e.shiftKey||nq||d||(window.dispatchEvent(new CustomEvent("unstable_sanity/dragApplyMinimap")),setTimeout(()=>{j()},50))},I=e=>{if(e.preventDefault(),nG=function(e){let t=document.body,n=window.getComputedStyle(t).transform;if("none"===n)return{x:e.x,y:e.y};let r=new DOMMatrix(n).inverse(),i=new DOMPoint(e.x,e.y).matrixTransform(r);return{x:i.x,y:i.y}}(nH=nU(e)),4>Math.abs(nT(nH,m)))return;if(!x){let e=nV(u),t=nW(nH,r,1);o({type:"overlay/dragStart",flow:c}),o({type:"overlay/dragUpdateSkeleton",skeleton:t}),o({type:"overlay/dragUpdateGroupRect",groupRect:e}),x=!0,s()}o({type:"overlay/dragUpdateCursorPosition",x:nH.x,y:nH.y}),!e.shiftKey||nq||d||(window.dispatchEvent(new CustomEvent("unstable_sanity/dragApplyMinimap")),setTimeout(()=>{j()},50));let t=function(e,t,n){if("horizontal"===n){let r={x1:e.x,y1:e.y,x2:e.x-1e8,y2:e.y},i={x1:e.x,y1:e.y,x2:e.x+1e8,y2:e.y};return{left:nL(r,t,n),right:nL(i,t,n)}}{let r={x1:e.x,y1:e.y,x2:e.x,y2:e.y-1e8},i={x1:e.x,y1:e.y,x2:e.x,y2:e.y+1e8};return{top:nL(r,t,n),bottom:nL(i,t,n)}}}(nH,u,c);JSON.stringify(g)!==JSON.stringify(t)&&o({type:"overlay/dragUpdateInsertPosition",insertPosition:nN(i,g=t,c)})},A=()=>{k=!1,o({type:"overlay/dragEnd",target:a,insertPosition:g?nN(i,g,c):null,dragGroup:p,flow:c,preventInsertDefault:f}),E&&o({type:"overlay/dragToggleMinimapPrompt",display:!1}),nq||(clearInterval(_),l(),C(),$()),P()},O=e=>{"Shift"===e.key&&nq&&(nq=!1,o({type:"overlay/dragUpdateSkeleton",skeleton:nW(nH,r,1/w)}),window.dispatchEvent(new CustomEvent("unstable_sanity/dragResetMinimap")),setTimeout(()=>{nB(nG.y,v,nZ,o,150,nK)},50),o({type:"overlay/dragUpdateGroupRect",groupRect:null}),k||(clearInterval(_),P(),C(),$(),l()))},M=()=>{o({type:"overlay/dragUpdateGroupRect",groupRect:null}),window.dispatchEvent(new CustomEvent("unstable_sanity/dragResetMinimap")),setTimeout(()=>{nB(nG.y,v,nZ,o,150,nK).then(()=>{nq=!1})},50),clearInterval(_),P(),C(),$(),l()},P=()=>{window.removeEventListener("mousemove",I),window.removeEventListener("wheel",S),window.removeEventListener("mouseup",A)},$=()=>{window.removeEventListener("keyup",O)},C=()=>{window.removeEventListener("blur",M)};window.addEventListener("blur",M),window.addEventListener("keyup",O),window.addEventListener("wheel",S),window.addEventListener("mousemove",I),window.addEventListener("mouseup",A)}({element:y,handler:e,mouseEvent:t,overlayGroup:o,target:i,onSequenceStart:()=>{d=!0},onSequenceEnd:()=>{setTimeout(()=>{d=!1},250)}})},mousemove(e){b.mouseenter(e);let t=e.currentTarget;t&&(t.addEventListener("mouseenter",b.mouseenter),t.addEventListener("mouseleave",b.mouseleave))},mouseenter(){document.querySelector("vercel-live-feedback")&&y.closest("[data-vercel-edit-info]")||y.closest("[data-vercel-edit-target]")||(f.push(y),e({type:"element/mouseenter",id:w,rect:n$(y)}),v())},mouseleave(n){function r(){f.pop();let t=h();if(e({type:"element/mouseleave",id:w}),t){let n=a.get(t);n&&e({type:"element/mouseenter",id:n.id,rect:n$(t)})}v()}let{relatedTarget:i}=n,o=nX(i),s=t.contains(o);if(nY(o)&&s)return function e(t){let n=i=>{let{relatedTarget:o}=i;nX(o)?o&&nY(o)&&(t.removeEventListener("mouseleave",n),e(o)):(t.removeEventListener("mouseleave",n),r())};t.addEventListener("mouseleave",n)}(o);r()}},w=function(e,t,n){if(nP.randomUUID&&!e)return nP.randomUUID();var r=(e=e||{}).random||(e.rng||function(){if(!nO&&!(nO="u">typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return nO(nM)})();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,function(e,t=0){return(nE[e[t+0]]+nE[e[t+1]]+nE[e[t+2]]+nE[e[t+3]]+"-"+nE[e[t+4]]+nE[e[t+5]]+"-"+nE[e[t+6]]+nE[e[t+7]]+"-"+nE[e[t+8]]+nE[e[t+9]]+"-"+nE[e[t+10]]+nE[e[t+11]]+nE[e[t+12]]+nE[e[t+13]]+nE[e[t+14]]+nE[e[t+15]]).toLowerCase()}(r)}(),x={id:w,elements:u,sanity:p,handlers:b};s.add(y),l.set(m,y),o.set(w,y),a.set(y,x),c?.observe(y),e({type:"element/register",id:w,element:y,rect:n$(y),sanity:p,dragDisabled:!!y.getAttribute("data-sanity-drag-disable")}),i&&g(x)}(p)}}function w(t){let n=a.get(t);if(n){let{id:r,handlers:i}=n;y(t,i),u.unobserve(t),a.delete(t),s.delete(t),o.delete(r),e({type:"element/unregister",id:r})}}function x(t){let n=a.get(t);n&&e({type:"element/updateRect",id:n.id,rect:n$(t)})}function E(e){if(i)for(let t of e){let{target:e}=t,n=nY(e)&&a.get(e);n&&(t.isIntersecting?g(n):m(n))}}function k(t){let n=nX(t.target);n?"capture"===n.dataset.sanityOverlayElement&&(t.preventDefault(),t.stopPropagation()):(f=[],e({type:"overlay/blur"}))}function _(){for(let e of s)x(e)}function j(t){"Escape"===t.key&&(f=[],e({type:"overlay/blur"}))}function S(e){let{target:t}=e;if(t!==window.document&&nY(t))for(let e of s)t.contains(e)&&x(e)}function I(){i||(c=new IntersectionObserver(E,{threshold:.3}),s.forEach(e=>c.observe(e)),e({type:"overlay/activate"}),i=!0)}function A(){i&&(c?.disconnect(),s.forEach(e=>{let t=a.get(e);t&&m(t)}),e({type:"overlay/deactivate"}),i=!1)}return window.document.fonts.ready.then(()=>{for(let e of s)x(e)}),window.addEventListener("click",k),window.addEventListener("contextmenu",k),window.addEventListener("keydown",j),window.addEventListener("resize",_),window.addEventListener("scroll",S,{capture:!0,passive:!0}),u=new ResizeObserver(function(e){for(let t of e){let e=t.target;if(nY(e)){let t=l.get(e);if(!t)return;x(t)}}}),(p=new MutationObserver(function(e){let n=!1;for(let r of e){let{target:e,type:i}=r,o="characterData"===i?e.parentElement:e;o===t||t.contains(o)||(n=!0,nY(o)&&b({childNodes:[o]}))}if(n)for(let e of s)e.isConnected||w(e)})).observe(document.body,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),b(document.body),I(),{activate:I,deactivate:A,destroy:function(){window.removeEventListener("click",k),window.removeEventListener("contextmenu",k),window.removeEventListener("keydown",j),window.removeEventListener("resize",_),window.removeEventListener("scroll",S),p.disconnect(),u.disconnect(),s.forEach(e=>{w(e)}),o.clear(),s.clear(),f=[],A()}}}({handler:t,overlayElement:e,inFrame:n,optimisticActorReady:i}),()=>{r.current?.destroy(),r.current=void 0}},[e,t,n,i]),r}(a,(0,d.useCallback)(e=>{if("element/click"===e.type){let{sanity:n}=e;t?.post({type:"visual-editing/focus",data:n})}else if("overlay/activate"===e.type)t?.post({type:"visual-editing/toggle",data:{enabled:!0}});else if("overlay/deactivate"===e.type)t?.post({type:"visual-editing/toggle",data:{enabled:!1}});else if("overlay/dragEnd"===e.type){let{insertPosition:t,target:n,dragGroup:r,flow:i,preventInsertDefault:o}=e;s({insertPosition:t,target:n,dragGroup:r,flow:i,preventInsertDefault:o})}else{if("overlay/dragUpdateCursorPosition"===e.type)return void i(e.x,e.y);if("overlay/setCursor"===e.type){let{element:t,cursor:n}=e;t.style.cursor=n}}n(e)},[t,n,s,i]),r);return(0,d.useEffect)(()=>{o?l.current?.activate():l.current?.deactivate()},[l,o]),null},rG=e=>{let{comlink:t,componentResolver:n,inFrame:i,zIndex:o}=e,[a,s]=(0,d.useState)(),l=(0,nh.u)(),[{contextMenu:u,dragInsertPosition:f,dragShowMinimap:h,dragShowMinimapPrompt:y,dragSkeleton:g,elements:m,isDragging:v,perspective:b,wasMaybeCollapsed:w,dragMinimapTransition:x,dragGroupRect:E},k]=(0,d.useReducer)(rT,{contextMenu:null,dragInsertPosition:null,dragShowMinimap:!1,dragShowMinimapPrompt:!1,dragSkeleton:null,elements:[],focusPath:"",isDragging:!1,perspective:"published",wasMaybeCollapsed:!1,dragMinimapTransition:!1,dragGroupRect:null}),[_,j]=(0,d.useState)(null),[S,I]=(0,d.useState)(!0);(0,d.useEffect)(()=>{let e=[t?.on("presentation/focus",e=>{k({type:"presentation/focus",data:e})}),t?.on("presentation/blur",e=>{k({type:"presentation/blur",data:e})}),t?.on("presentation/toggle-overlay",()=>{I(e=>!e)}),t?.onStatus(e=>{s(e)})].filter(Boolean);return()=>e.forEach(e=>e())},[t]),function(e,t){(0,d.useEffect)(()=>{let n=new AbortController;e?.fetch({type:"visual-editing/fetch-perspective",data:void 0},{signal:n.signal,suppressWarnings:!0}).then(e=>{t({type:"presentation/perspective",data:e})}).catch(()=>{});let r=e?.on("presentation/perspective",e=>{t({type:"presentation/perspective",data:e})});return()=>{r?.(),n.abort()}},[e,t])}(t,k),function(e,t,n){let r=(0,d.useRef)(void 0),i=(0,d.useCallback)((t,n)=>{e?.post({type:"visual-editing/documents",data:{documents:t,perspective:n}})},[e]);(0,d.useEffect)(()=>{let e=t.map(e=>{let{sanity:t}=e;return"id"in t?{...t,id:"isDraft"in t?`${tZ}${t.id}`:t.id}:null}).filter(e=>!!e),o=new Set(e.map(e=>e.id));if(!r.current||!function(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}(o,r.current.nodeIds)||n!==r.current.perspective){let t=Array.from(o).map(t=>{let{type:n,projectId:r,dataset:i}=e.find(e=>e.id===t);return r&&i?{_id:t,_type:n,_projectId:r,_dataset:i}:{_id:t,_type:n}});r.current={nodeIds:o,perspective:n},i(t,n)}},[t,n,i])}(t,m,b);let A=(0,d.useCallback)((e,t)=>{_&&(_.style.setProperty("--drag-preview-x",`${e}px`),_.style.setProperty("--drag-preview-y",t-window.scrollY+"px"))},[_]);(0,d.useEffect)(()=>{let e=e=>{let t=e.target;if(((0,nh.x)(t)||(0,nh.y)(t)&&t.closest("a"))&&e.altKey){e.preventDefault(),e.stopPropagation();let t=new MouseEvent(e.type,{...e,altKey:!1,bubbles:!0,cancelable:!0});e.target?.dispatchEvent(t)}},t=e=>{p(e)&&I(e=>!e)},n=e=>{p(e)&&I(e=>!e),function(e,t){return e.every(e=>c[e]?t[c[e]]:t.key===e.toUpperCase())}(["mod","\\"],e)&&I(e=>!e)};return window.addEventListener("click",e),window.addEventListener("keydown",n),window.addEventListener("keyup",t),()=>{window.removeEventListener("click",e),window.removeEventListener("keydown",n),window.removeEventListener("keyup",t)}},[I]);let[O,M]=(0,d.useState)(!1),[P,$]=(0,d.useState)(!1),C=(0,d.useRef)(void 0);(0,d.useEffect)(()=>{if(S)return rV(()=>{M(!0),rV(()=>{$(!0),C.current=setTimeout(()=>{$(!1),M(!1)},1500)})});C.current&&(clearTimeout(C.current),M(!1),$(!1))},[S]);let R=(0,d.useMemo)(()=>i&&"connected"!==a?[]:m.filter(e=>e.activated||e.focused),[m,i,a]),T=(0,d.useMemo)(()=>m.flatMap(e=>"id"in e.sanity?[e.sanity.id]:[]),[m]),L=(0,d.useCallback)(()=>{k({type:"overlay/blur"})},[]),D=na(),F=(0,d.useMemo)(()=>D?n:void 0,[n,D]);return(0,r.jsx)(nh.t,{scheme:l?"dark":"light",theme:nh.v,tone:"transparent",children:(0,r.jsx)(nh.L,{children:(0,r.jsx)(nh.w,{element:_,children:(0,r.jsx)(rz,{comlink:t,elements:m,children:(0,r.jsx)(rL,{comlink:t,children:(0,r.jsx)(rU,{comlink:t,children:(0,r.jsxs)(rW,{"data-fading-out":P?"":void 0,"data-overlays":O?"":void 0,ref:j,$zIndex:o,children:[(0,r.jsx)(rB,{documentIds:T,perspective:b}),(0,r.jsx)(rq,{comlink:t,dispatch:k,inFrame:i,onDrag:A,overlayEnabled:S,rootElement:_}),u&&(0,r.jsx)(rv,{...u,onDismiss:L}),!v&&R.map(({id:e,element:t,focused:n,hovered:o,rect:a,sanity:s,dragDisabled:l})=>{let u=!l&&!!t.getAttribute("data-sanity")&&D&&m.some(e=>"id"in e.sanity&&"id"in s&&n5(e.sanity,s)&&e.sanity.path!==s.path);return(0,r.jsx)(rS,{componentResolver:F,element:t,enableScrollIntoView:!v&&!x&&!h,focused:n,hovered:o,node:s,rect:a,showActions:!i,draggable:u,isDragging:v||x,wasMaybeCollapsed:n&&w},e)}),v&&!x&&(0,r.jsxs)(r.Fragment,{children:[f&&(0,r.jsx)(rO,{dragInsertPosition:f}),y&&(0,r.jsx)(rC,{}),E&&(0,r.jsx)(rA,{dragGroupRect:E})]}),v&&g&&(0,r.jsx)(rP,{skeleton:g})]})})})})})})})},rH=e=>{let{comlink:t,refresh:n}=e,r=(0,d.useRef)(0),i=(0,d.useRef)(0);return(0,d.useEffect)(()=>t.on("presentation/refresh",e=>{if("manual"===e.source){clearTimeout(r.current);let i=n(e);if(!1===i)return;t.post({type:"visual-editing/refreshing",data:e});let o=!1;r.current=window.setTimeout(()=>{t.post({type:"visual-editing/refreshed",data:e}),o=!0},3e3),i?.finally?.(()=>{o||(clearTimeout(r.current),t.post({type:"visual-editing/refreshed",data:e}))})}else if("mutation"===e.source){clearTimeout(i.current);let r=n(e);if(!1===r)return;t.post({type:"visual-editing/refreshing",data:e}),i.current=window.setTimeout(()=>{let r=n(e);!1!==r&&(t.post({type:"visual-editing/refreshing",data:e}),r?.finally?.(()=>{t.post({type:"visual-editing/refreshed",data:e})})||t.post({type:"visual-editing/refreshed",data:e}))},1e3),r?.finally?.(()=>{t.post({type:"visual-editing/refreshed",data:e})})||t.post({type:"visual-editing/refreshed",data:e})}}),[t,n]),null},rZ=e=>{let{components:t,history:n,refresh:o,zIndex:a}=e,s=window.self!==window.top||window.opener,[l,c]=(0,d.useState)(void 0);return(0,d.useEffect)(()=>{if(!s)return;let e=(0,i.dS)({name:"visual-editing",connectTo:"presentation"},(0,i.zB)().provide({actors:u()}));c(e);let t=function(e){let t=new eU(1),n=new eI;return e.fetch({type:"visual-editing/snapshot-welcome",data:void 0},{suppressWarnings:!0}).then(e=>{t.next(e.event)}).catch(()=>{}),e.on("presentation/snapshot-event",e=>{"reconnect"===e.event.type&&t.next(e.event),"mutation"===e.event.type&&n.next(e.event)}),ez(t,n)}(e),n=nt.provide({actors:{documentMutatorMachine:ra(e)}}),r=(0,y.A)(n,{input:{client:{withConfig:()=>{}},sharedListener:t}}),o=new AbortController;return e.fetch({type:"visual-editing/features",data:void 0},{signal:o.signal,suppressWarnings:!0}).then(e=>{e.features.optimistic&&function(e){for(let t of(nr=e,ni))t()}(r)}).catch(()=>{console.warn("[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.")}),r.start(),e.start(),()=>{o.abort(),r.stop(),e.stop()}},[s]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(rG,{comlink:l,componentResolver:t,inFrame:s,zIndex:a}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(rs,{comlink:l,history:n}),(0,r.jsx)(rl,{comlink:l}),o&&(0,r.jsx)(rH,{comlink:l,refresh:o})]})]})};rZ.displayName="VisualEditing";var rK=n(16463),rY=n(69445),rX=n(54887);function rJ(e){let t=e.indexOf("#"),n=e.indexOf("?"),r=n>-1&&(t<0||n<t);return r||t>-1?{pathname:e.substring(0,r?n:t),query:r?e.substring(n,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}function rQ(e,t){if(!function(e,t){if("string"!=typeof e)return!1;let{pathname:n}=rJ(e);return n===t||n.startsWith(`${t}/`)}(e,t))return e;let n=e.slice(t.length);return n.startsWith("/")?n:`/${n}`}let r0=(e,t)=>{let{pathname:n,query:r,hash:i}=rJ(e);return t?n.endsWith("/")?`${n}${r}${i}`:`${n}/${r}${i}`:`${n.replace(/\/$/,"")||"/"}${r}${i}`};function r1(e){let{basePath:t="",components:n,refresh:i,trailingSlash:o=!1,zIndex:a}=e,s=(0,rK.useRouter)(),l=(0,d.useRef)(s),[u,c]=(0,d.useState)();(0,d.useEffect)(()=>{l.current=s},[s]);let p=(0,d.useMemo)(()=>({subscribe:e=>(c(()=>e),()=>c(void 0)),update:e=>{switch(e.type){case"push":return l.current.push(rQ(e.url,t));case"pop":return l.current.back();case"replace":return l.current.replace(rQ(e.url,t));default:throw Error(`Unknown update type: ${e.type}`)}}}),[t]),f=(0,rK.usePathname)(),h=(0,rK.useSearchParams)();(0,d.useEffect)(()=>{u&&u({type:"push",url:r0(function(e,t){if(!e.startsWith("/")||!t)return e;if("/"===e&&t)return t;let{pathname:n,query:r,hash:i}=rJ(e);return`${t}${n}${r}${i}`}(`${f}${h?.size?`?${h}`:""}`,t),o)})},[t,u,f,h,o]);let y=(0,d.useCallback)(e=>{if(i)return i(e);switch(e.source){case"manual":return e.livePreviewEnabled?(console.debug("Live preview is setup, calling router.refresh() to refresh the server components without refetching cached data"),l.current.refresh(),Promise.resolve()):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),(0,rY.b)());case"mutation":return e.livePreviewEnabled?(console.debug("Live preview is setup, mutation is skipped assuming its handled by the live preview"),!1):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),(0,rY.b)());default:throw Error("Unknown refresh source",{cause:e})}},[i]),[g,m]=(0,d.useState)(null);return(0,d.useEffect)(()=>{let e=document.createElement("div");return e.id="sanity-visual-editing",document.documentElement.appendChild(e),m(e),()=>{m(null),document.documentElement.contains(e)&&document.documentElement.removeChild(e)}},[]),g?(0,rX.createPortal)((0,r.jsx)(rZ,{components:n,history:p,refresh:y,zIndex:a}),g):null}}}]);